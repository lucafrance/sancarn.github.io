<article class="reader__content" role="main" itemtype="http://schema.org/NewsArticle">
  <!---->
        <figure class="reader-cover-image--grid relative">
          <div class="reader-cover-image--wrapper">
              <img src="https://media.licdn.com/media/gcrc/dms/image/C4E12AQFODkyQMWZD7Q/article-cover_image-shrink_423_752/0?e=1558569600&amp;v=beta&amp;t=XSOixtV4Sq30G_xWhg8wMQA2SFRs-qL8uJemOxEzn0w" class="reader-cover-image__img" alt="A master-database tree-view created with Ruby">
          </div>
            <figcaption itemprop="caption" class="reader-cover-image__caption t-12 t-black--light t-normal">A master-database tree-view created with Ruby</figcaption>
        </figure>
      <div class="relative reader__grid">
        <header id="reader-article-header">
  <!---->        <h1 dir="ltr" class="reader-article-header__title t-40 t-black t-normal pv4"> InfoWorks ICM - GUIs with Ruby (Part 1)</h1>
          <ul class="reader-article-header__meta t-14 t-black--light t-normal mv4">
            <li>
              <time class="reader-article-header__publish-date">
                Published on May 19, 2018
              </time>
            </li>
              <li class="reader-article-header__author-list-item">
  <a data-control-name="edit" rel="noopener noreferrer" target="_blank" href="https://www.linkedin.com/post/edit/6402998707280760832" id="ember1243" class="reader-author-info__edit-article artdeco-button artdeco-button--tertiary artdeco-button--1 ember-view">                <li-icon aria-hidden="true" type="pencil-icon" class="reader-article-header__author-button-icon artdeco-button__icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M14.71,4L12,1.29a1,1,0,0,0-1.41,0L3,8.85,1,15l6.15-2,7.55-7.55A1,1,0,0,0,15,4.71,1,1,0,0,0,14.71,4Zm-8.84,7.6-1.5-1.5L9.42,5.07l1.5,1.5Zm5.72-5.72-1.5-1.5,1.17-1.17,1.5,1.5Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
                  <span class="artdeco-button__text">
                    Edit article
                  </span>
  </a>            </li>
              <li class="reader-article-header__author-list-item">
  <a data-control-name="analytics" href="/pulse/infoworks-icm-guis-ruby-part-1-james-warren/ca/post-analytics/urn:li:linkedInArticle:6402998707280760832/" id="ember1244" class="artdeco-button artdeco-button--tertiary artdeco-button--1 reader-author-info__author-analytics ember-view">                <li-icon aria-hidden="true" type="analytics-icon" class="reader-article-header__author-button-icon artdeco-button__icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M4,12H14v2H3a1,1,0,0,1-1-1V2H4V12Zm9.31-9.93L10.25,4l1.09,0.58L10,7.21,7.7,6.06a0.75,0.75,0,0,0-1,.33l-2,3.92L6.28,11.1l1.53-3,2.3,1.16a0.75,0.75,0,0,0,1-.33L12.9,5.35,14,5.93V2.45A0.45,0.45,0,0,0,13.31,2.07Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
                  <span class="artdeco-button__text">
                    View stats
                  </span>
  </a>            </li>
          </ul>
        </header>
  
  <div id="ember1245" class="reader-author-info__sticky reader-author-info__sticky_content sticky ember-view">          <div class="reader-author-info__container-wrapper">
    <div class="reader-author-info__container display-flex align-items-center justify-space-between">
        <div id="ember1246" class="reader-author-info ember-view"><artdeco-entity-lockup size="4" id="ember1247" class="artdeco-entity-lockup--size-4 artdeco-entity-lockup ember-view"><artdeco-entity-lockup-image id="ember1248" class="artdeco-entity-lockup__image artdeco-entity-lockup__image--type-circle ember-view" type="circle"><a data-control-name="profile" href="/in/james--warren/" id="ember1249" class="reader-author-info__meta-image ember-view">        <img class="lazy-image loaded" alt="" src="https://media.licdn.com/dms/image/C4D03AQFfVgF30oZvdQ/profile-displayphoto-shrink_800_800/0?e=1558569600&amp;v=beta&amp;t=uaw--pYD6glJTBuDamE2IpRpKM_L3h2wEN9I5kyTTYQ">
  </a>
  </artdeco-entity-lockup-image><artdeco-entity-lockup-content id="ember1250" class="reader-author-info__content mr2 artdeco-entity-lockup__content ember-view"><artdeco-entity-lockup-title id="ember1251" class="reader-author-info__author-lockup--flex artdeco-entity-lockup__title ember-view"><a data-control-name="profile" href="/in/james--warren/" id="ember1252" class="reader-author-info__meta-name display-flex align-items-center ember-view">        <h2 class="reader-author-info__text reader-author-info__name t-16 t-black--light t-bold reader-author-info__meta-author-detail--has-hover mr2">
            James Warren
  <!---->        </h2>
  </a><!---->
  </artdeco-entity-lockup-title><artdeco-entity-lockup-subtitle id="ember1253" class="artdeco-entity-lockup__subtitle ember-view">        <div id="ember1255" class="ember-view">    <span class="lt-line-clamp__line lt-line-clamp__line--last">
        GIS Analyst / Software Engineer<!----></span>
  
  <!----><span class="lt-line-clamp__ellipsis lt-line-clamp__ellipsis--dummy">... <a class="lt-line-clamp__more" href="#">See more</a></span></div>
  
  </artdeco-entity-lockup-subtitle><artdeco-entity-lockup-metadata id="ember1256" class="artdeco-entity-lockup__metadata ember-view"><a data-control-name="read-activity" href="/in/james--warren/detail/recent-activity/posts/" id="ember1278" class="reader-author-info__total-articles link ember-view">          11 articles
  </a></artdeco-entity-lockup-metadata></artdeco-entity-lockup-content>
  </artdeco-entity-lockup></div>
        <div id="ember1257" class="reader-social-bar ember-view"><ul class="reader-social-bar__items">
      <li class="reader-social-bar__social-action">
  <a data-control-name="analytics" href="/pulse/infoworks-icm-guis-ruby-part-1-james-warren/ca/post-analytics/urn:li:linkedInArticle:6402998707280760832/" id="ember1279" class="ember-view">        <button class="artdeco-button artdeco-button--secondary artdeco-button--1 artdeco-button--muted artdeco-button--circle reader-social-bar__button reader-social-bar__views">
            <li-icon aria-hidden="true" type="eyeball-icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M8,2C2.4,2,0,8,0,8s2.35,6,8,6,8-6,8-6S13.6,2,8,2ZM8,12.25C4.57,12.25,2.64,9.34,1.94,8,2.65,6.68,4.61,3.75,8,3.75S13.35,6.67,14.06,8C13.36,9.33,11.42,12.25,8,12.25ZM8,5a3,3,0,1,0,3,3A3,3,0,0,0,8,5ZM8,9.25A1.25,1.25,0,1,1,9.25,8,1.25,1.25,0,0,1,8,9.25Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
          </button>
          <span class="reader-social-bar__count t-14 t-black--light t-bold">
            321
          </span>
  </a>    </li>
    <li class="reader-social-bar__social-action">
      <button data-control-name="like" aria-pressed="false" aria-label="Like" id="ember1258" class="artdeco-button--muted  like-button button like artdeco-button artdeco-button--secondary artdeco-button--1 artdeco-button--circle reader-social-bar__button ember-view">  <li-icon aria-hidden="true" type="like-icon" class="like-icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M11.6,7L9.7,3.8C9.4,3.3,9.2,2.7,9,2.1L8.8,1c0,0,0,0,0,0H7C5.9,1,5,1.9,5,3v0.4C5,4,5.1,4.7,5.3,5.3L5.5,6c0,0,0,0,0,0l-3,0C1.7,6,1,6.7,1,7.5c0,0.4,0.1,0.7,0.4,1c0,0,0,0,0,0C1.1,8.8,1,9.1,1,9.5c0,0.5,0.3,1,0.7,1.3c0,0,0,0,0,0c-0.1,0.2-0.2,0.5-0.2,0.7c0,0.8,0.6,1.4,1.3,1.5c0,0,0,0,0,0c-0.1,0.3-0.1,0.6,0,1c0.2,0.6,0.9,1,1.5,1H7c0.9,0,1.5-0.1,2.1-0.3l2.1-0.7c0,0,0,0,0,0H14c0,0,0,0,0,0V7c0,0,0,0,0,0L11.6,7C11.6,7,11.6,7,11.6,7zM3.4,10.1L3,9.6C2.9,9.4,2.8,9.2,2.9,8.9L3,8c0,0,0,0,0,0l5.1,0c0,0,0,0,0,0L7,4.7C6.9,4.3,6.9,3.8,6.9,3.4V3.1c0-0.2,0.2-0.4,0.4-0.4c0,0,0.1,0,0.1,0c0.1,0.7,0.4,1.5,0.7,2L10.7,9c0,0,0,0,0,0H12c0,0,0,0,0,0v3c0,0,0,0,0,0h-0.6c0,0,0,0,0,0l-2.5,0.8C8.5,12.9,8.1,13,7.7,13H4.9c-0.2,0-0.4-0.2-0.5-0.4l-0.1-0.5l-0.6-0.5c-0.2-0.2-0.4-0.5-0.3-0.8L3.4,10.1z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
    <li-icon aria-hidden="true" type="like-filled-icon" class="unlike-icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M11.64,7L9.71,3.77A6,6,0,0,1,9,2.13L8.75,1H8A2,2,0,0,0,6,3V3.15A7.81,7.81,0,0,0,6.43,5.3L6.66,6a0,0,0,0,1,0,0H2.5A1.49,1.49,0,0,0,1.38,8.49a0,0,0,0,1,0,0,1.49,1.49,0,0,0,.31,2.25,0,0,0,0,1,0,0A1.48,1.48,0,0,0,2.83,13a0,0,0,0,1,0,0,1.38,1.38,0,0,0,0,1,1.62,1.62,0,0,0,1.51,1H7a6.47,6.47,0,0,0,2.14-.31L11.25,14H14V7H11.64Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
  
  <!---->
  <span class="visually-hidden">
        Like
  </span>
  
  </button>
      <button class="t-14 t-black--light t-bold reader-social-bar__like-count reader-social-bar__count " data-ember-action="" data-ember-action-1259="1259">
        36
      </button>
    </li>
    <li class="reader-social-bar__social-action">
      <button data-control-name="comment_intent" id="ember1260" class="button comment artdeco-button artdeco-button--secondary artdeco-button--1 artdeco-button--muted artdeco-button--circle reader-social-bar__button reader-social-bar__comment ember-view"><li-icon aria-hidden="true" type="speech-bubble-icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M14,3H2A1,1,0,0,0,1,4v7a1,1,0,0,0,1,1h9l4,3V4A1,1,0,0,0,14,3ZM3,10V5H13v6.11L11.52,10H3ZM5,7h6V8H5V7Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon><span aria-hidden="true"></span>
  
  <span class="visually-hidden">
    Comment
  </span>
  </button>
  <!---->    <span class="t-14 t-black--light t-bold reader-social-bar__count">
        5
      </span>
    </li>
  
    <li class="reader-social-bar__social-action">
        <button data-control-name="share_intent" id="ember1261" class="reader-social-bar__button reader-social-bar__share artdeco-button artdeco-button--circle artdeco-button--muted artdeco-button--1 artdeco-button--secondary ember-view">  <li-icon aria-hidden="true" type="share-linkedin-icon" class="artdeco-button__icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M15.7,7.3L9,1v4H7c-3.9,0-7,3.1-7,7v3h1.4c0-2.2,1.9-4,4.1-4c0,0,0.1,0,0.1,0H9v4l0,0l6.7-6.3C16.1,8.4,16.1,7.7,15.7,7.3C15.7,7.3,15.7,7.3,15.7,7.3z M11,10.6V9H5.6c-1.2,0-2.4,0.4-3.4,1.1C3.1,8.2,4.9,7,7,7h4V5.4L13.7,8L11,10.6z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
  
  <span class="artdeco-button__text">
      
  </span></button>
  
        <span class="t-14 t-black--light t-bold reader-social-bar__count">
          1
        </span>
  
        <div id="ember1262" class="reader-social-bar__external-share external-social-share ember-view"><!----></div>
    </li>
  </ul>
  </div>
      <div id="ember1263" class="reader-author-info__cta ml2 ember-view"><a data-control-name="edit" rel="noopener noreferrer" target="_blank" href="https://www.linkedin.com/post/edit/6402998707280760832" id="ember1264" class="reader-author-info__cta-link reader-author-info__edit-article artdeco-button artdeco-button--tertiary artdeco-button--1 ember-view">    <li-icon aria-hidden="true" type="pencil-icon" class="reader-author-info__cta-icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M14.71,4L12,1.29a1,1,0,0,0-1.41,0L3,8.85,1,15l6.15-2,7.55-7.55A1,1,0,0,0,15,4.71,1,1,0,0,0,14.71,4Zm-8.84,7.6-1.5-1.5L9.42,5.07l1.5,1.5Zm5.72-5.72-1.5-1.5,1.17-1.17,1.5,1.5Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
      Edit article
  </a>
  </div>
    </div>
  </div>
  
  
  </div>
          <div id="ember1265" class="ember-view"><div id="ember1266" class="ember-view"><!----></div></div>
  
        <div id="ember1267" class="ember-view"><div id="ember1268" class="ember-view"><!----></div></div>
  
        <div id="ember1269" class="ember-view"><div dir="ltr" class="reader-article-content"><p>We use Graphical User Interfaces (GUIs) to display information and interact with the user.</p> 
  <p>In InfoWorks ICM, Innovyze have given us a few standard GUIs to work with. Each standard GUI will open a separate window containing varying GUI controls, depending on the parameters given.</p> 
  <ul> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#file_dialog-ui-only" target="_blank" rel="nofollow noopener">WSApplication.file_dialog</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#folder_dialog-ui-only" target="_blank" rel="nofollow noopener">WSApplication.folder_dialog</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#graph-ui-only" target="_blank" rel="nofollow noopener">WSApplication.graph&nbsp;(I haven't been able to get this to work in ICM 6.5.6)</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#input_box-ui-only" target="_blank" rel="nofollow noopener">WSApplication.input_box</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#message_box-ui-only" target="_blank" rel="nofollow noopener">WSApplication.message_box</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#open_text_view-ui-only" target="_blank" rel="nofollow noopener">WSApplication.open_text_view</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#prompt-ui-only" target="_blank" rel="nofollow noopener">WSApplication.prompt</a></li> 
   <li><a href="https://github.com/sancarn/Innovyze-ICM-Libraries/tree/master/docs/Infoworks-ICM#scalars-ui-only" target="_blank" rel="nofollow noopener">WSApplication.scalars</a></li> 
  </ul> 
  <p>These standard GUIs are great but if we throw dialog after dialog at the user, it can often confuse them more than it helps them. Ideally, we want 1 fully customisable GUI containing all the buttons, text boxes and other UI controls required to perform the task. Furthermore, what if you want a GUI with a control that is not standard? E.G. You might want a treeview, listview or grid? What if you'd like your button's to be named differently, or show dynamic text which changes with the user's choices? Unfortunately, the InfoWorks ICM API fails to provide any support for these behaviors in the standard GUI functions.</p> 
  <p>In this mini series we are going to explore alternative systems that we can use to build fully customisable GUIs for use in ICM.</p> 
  <p>Today, we're going to build custom GUIs with Powershell!</p> 
  <h2>Powershell</h2> 
  <p>PowerShell is a shell-like programming language created by Microsoft. Powershell is installed on all systems running Windows 7 and above, and thus alone makes Powershell an ideal candidate for GUI framework, as this will support all recent major versions of Infoworks ICM.</p> 
  <p>But how do we build GUIs in Powershell?</p> 
  <p>Powershell was built on top of the .NET framework and therefore has full access to&nbsp;<a href="https://en.wikipedia.org/wiki/Windows_Forms" target="_blank" rel="nofollow noopener">Windows Forms</a>. It is this library that we will use to make our fully customisable GUIs.</p> 
  <h3>Powershell Syntax</h3> 
  <p>I found numerous syntax overviews&nbsp;<a href="http://www.computerperformance.co.uk/powershell/powershell_syntax.htm" target="_blank" rel="nofollow noopener">online</a>, however I figured I should give a short overview myself, found below...</p> 
  <p>The first thing to note is that Powershell is a "shell based scripting language" and thus every object, class, function etc. in Powershell is treated as an 'application', as it were, in Command Prompt. This brings some unique behaviors which look quite bizarre to programmers who come from a C/Ruby/VB background.</p> 
  <p>All variable names must be prefixed with a&nbsp;<em>$</em>. So&nbsp;<em>houseCount = 5&nbsp;</em>would cause a syntax error. The correct syntax being&nbsp;<em>$houseCount = 5</em>.&nbsp;<em>$houseCount</em>&nbsp;is now an 'application' in it's own right. One common programmatic operation we might like to perform is logical operations,<em> (&lt;,&gt;,==,!=,...)</em>. E.G. in Ruby we would write:&nbsp;<em>if($houseCount &lt; 10){Write-Host "Too Few!"}</em>. Trying to execute this in Powershell will fail. Why? Because&nbsp;&lt;&nbsp;in command line means "Pipe to&nbsp;STDIN". Instead we have to use command line arguments of<em>&nbsp;$houseCount:&nbsp;if($houseCount -lt 10){Write-Host "Too Few!"}</em>. See the table below:</p> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" width="234" height="310" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fi.imgur.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fi.imgur.com%252Fkdo88sT.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fi.imgur.com%252Fkdo88sT.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fi.imgur.com%252Fkdo88sT.png%2522%252C%2522width%2522%253A234%252C%2522height%2522%253A270%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fi.imgur.com%252Fkdo88sT.png%2522%252C%2522width%2522%253A234%252C%2522height%2522%253A270%257D%257D%257D&amp;signature=AVNI_9EW5oSfRX5aYdYWudcM1VUG"></iframe> 
  <p>If you have a keen eye you might have noticed the&nbsp;<em>Write-Host</em>&nbsp;routine. The is equivalent to&nbsp;<em>puts</em>&nbsp;in Ruby. It is via&nbsp;<em>Write-Host</em>&nbsp;that we will output all data to STDOUT from Powershell to Ruby. Arrays and hashes are created with the&nbsp;<em>@</em>&nbsp;syntax:&nbsp;<em>$myArray=@(1,2,3)</em>&nbsp;and&nbsp;<em>$myHash = @{'foo'='bar', 'bash'=3}</em>. Looping through arrays and lists can be done with the&nbsp;<em>ForEach</em>&nbsp;statement:</p> 
  <pre spellcheck="false">  ForEach(<span class="hljs-variable">$num</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$myArray</span>){
      Write-Host <span class="hljs-variable">$num</span>
    }
    <span class="hljs-comment">#&gt;1#&gt;2#&gt;3</span>
  </pre> 
  <p>You can define functions and classes using the following syntax:</p> 
  <pre spellcheck="false">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span><span class="hljs-params">($a,$b)</span> </span>{
      $a+$b
    }
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMath</span> </span>{
      add($a,$b) {
        $a+$b
      }
    }
  </pre> 
  <p>Functions defined in this way are called without parenthesis:&nbsp;<em>$a = myFunc 1,2.</em> Instances of classes are created using one of the 2 following syntaxes:&nbsp;<em>$math = New-Object MyMath; $math.add(1,3)</em>&nbsp;or&nbsp;<em>[MyMath]::new().add(1,3)</em>. Did you notice the curly brackets used to call class functions? Yeah... That's Powershell for you. Whenever you call the method of an&nbsp;Object or&nbsp;Type&nbsp;you use curly brackets, where as all standard functions are called in the command-line convention.</p> 
  <p>This actually brings us nicely onto the typed side of Powershell. In general, Powershell is a dynamically typed language, like Ruby, but it has the ability to be statically typed as well. A typed variable is cast to a new type using the square brackets containing the type you want to cast to. E.G.&nbsp;<em>[Double]10</em>&nbsp;declares the number 10 of type double (<em>10</em>&nbsp;on it's own would create an integer).</p> 
  <p>If you ran the command&nbsp;<em>[Double]10</em>&nbsp;you might have noticed that 10 got printed to the STDOUT. Similarly when calling&nbsp;<em>[MyMath]::new().add(1,3)</em>,&nbsp;4&nbsp;is printed to STDOUT. Again, that's Powershell... You don't necessarily need to write&nbsp;<em>Write-Host</em>&nbsp;to write to the STDOUT... All you need is to execute a function without otherwise handling the result... To avoid this we can cast the result to&nbsp;void&nbsp;e.g.&nbsp;<em>[void][MyMath].new().add(1,3)</em>.</p> 
  <p>And that just about covers all you need to know to get started using Powershell!</p> 
  <h3>Powershell from ICM</h3> 
  <p>The Powershell application has the ability to be run from the command line. It offers a few ways to execute Powershell scripts through different command line arguments. There are numerous methods all of which are explained on&nbsp;<a href="https://docs.microsoft.com/en-us/powershell/scripting/core-powershell/console/powershell.exe-command-line-help?view=powershell-6" target="_blank" rel="nofollow noopener">docs.microsoft</a>, but in general we only care about how to execute Powershell scripts. After all, we ideally want to build a general Ruby library that will let us execute Powershell to our hearts content! The command line arguments we're interested in are as follows:</p> 
  <pre spellcheck="false">Powershell
             [-Command <span class="hljs-string">"&lt;&lt;powershell script goes here&gt;&gt;"</span>]
             [-EncodedCommand &lt;&lt;encoded powershell script goes here<span class="hljs-meta">&gt;&gt;</span>]
             [-File <span class="hljs-string">"&lt;&lt;Powershell file goes here&gt;&gt;"</span>]
  </pre> 
  <p>The&nbsp;-command&nbsp;argument is only really useful for 1 line powershell scripts. In our case we would want to execute arbitrary number of lines. The&nbsp;-file&nbsp;argument is also a very good option. If you specify a file path then Powershell will execute the specified file.</p> 
  <p>There are some slight downsides to this though, as we'd need to write the file with Ruby first, and this could be quite slow depending on hardware. However for larger Powershell scripts this may be our only option...</p> 
  <p>The&nbsp;-EncodedCommand&nbsp;argument was added to help users execute scripts that have potentially complex quote escaping. This command is what I've used in my Powershell class below, but it doesn't rule out the other arguments. The benefit to the encoded command to me is that the Ruby script stays entirely virtual, and is never written to the hard disk. However with large scripts&nbsp;-File&nbsp;might be a better option!</p> 
  <p>Ultimately, you can find my Powershell execution library below:</p> 
  <pre spellcheck="false"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Powershell</span><span class="hljs-comment">#exec() will execute any arbitrary powershell script which is not already encoded.def self.exec(data)#Encoding ensures there'll be no issues with complex quoted datarequire 'base64'</span></span>
          data = Base64.strict_encode64(data.encode(<span class="hljs-string">"utf-16le"</span>))
  
          <span class="hljs-comment">#Execute encoded commands:require 'win32ole'</span>
          shell = WIN32OLE.new(<span class="hljs-string">"WScript.Shell"</span>)
          app = shell.exec(<span class="hljs-string">"powershell -NoProfile -NonInteractive -WindowStyle Hidden -EncodedCommand \""</span> + data + <span class="hljs-string">"\""</span>)
          <span class="hljs-keyword">return</span> {<span class="hljs-symbol">:STDOUT=&gt;app</span>.StdOut.ReadAll(),<span class="hljs-symbol">:STDERR=&gt;app</span>.StdErr.ReadAll()}
      <span class="hljs-keyword">end</span>
  
      <span class="hljs-comment">#execEncoded() will execute any arbitrary powershell script which has already been encoded.def self.execEncoded(data)require 'win32ole'</span>
          shell = WIN32OLE.new(<span class="hljs-string">"WScript.Shell"</span>)
          app = shell.exec(<span class="hljs-string">"powershell -NoProfile -NonInteractive -WindowStyle Hidden -EncodedCommand \""</span> + data + <span class="hljs-string">"\""</span>)
          <span class="hljs-keyword">return</span> {<span class="hljs-symbol">:STDOUT=&gt;app</span>.StdOut.ReadAll(),<span class="hljs-symbol">:STDERR=&gt;app</span>.StdErr.ReadAll()}
      <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
  </pre> 
  <p>The&nbsp;<em>exec</em>&nbsp;method encodes the Powershell script string you give it, and then executes it with Powershell.&nbsp;<em>execEncoded</em>&nbsp;on the other hand executes a pre-encoded script (in-case you want your scripts to be shady).</p> 
  <p>Take a simple hello world example written in Powershell:</p> 
  <pre spellcheck="false">helloWorld=&lt;&lt;END_HELLOWORLD
      <span class="hljs-variable">$x</span> = <span class="hljs-string">"hello world"</span>
      Write-Host <span class="hljs-variable">$x</span>
  END_HELLOWORLD
  
  p Powershell.exec(helloWorld)
  </pre> 
  <p>This will print the following hash to the ICM script log:</p> 
  <pre spellcheck="false">{<span class="hljs-symbol">:STDOUT=&gt;<span class="hljs-string">"hello world"</span></span>, <span class="hljs-symbol">:STDERR=&gt;<span class="hljs-string">""</span></span>}
  </pre> 
  <p>The&nbsp;<em>execEncoded</em>&nbsp;method executes already encoded Powershell. This is less often useful, as most people want to keep their scripts readable... But each to their own!:</p> 
  <blockquote>
    Note: Encoding a script does not make it any more secure! Encoding is not the same as either encryption or obfuscation. 
  </blockquote> 
  <pre spellcheck="false"># [<span class="hljs-type">Write</span>-<span class="hljs-type">Host</span> <span class="hljs-string">"hello world"</span>] encoded <span class="hljs-keyword">with</span> [<span class="hljs-type">Convert</span>]::<span class="hljs-type">ToBase64String</span>([<span class="hljs-type">System</span>.<span class="hljs-type">Text</span>.<span class="hljs-type">Encoding</span>]::<span class="hljs-type">Unicode</span>.<span class="hljs-type">GetBytes</span>(<span class="hljs-symbol">'Write</span>-<span class="hljs-type">Host</span> <span class="hljs-string">"hello world"</span>'))
  helloEncode=<span class="hljs-string">"VwByAGkAdABlAC0ASABvAHMAdAAgACIAaABlAGwAbABvACAAdwBvAHIAbABkACIA"</span>
  
  p <span class="hljs-type">Powershell</span>.execEncoded(helloEncode)
  </pre> 
  <p>Now that we've got the basics down, let's build our first GUI with Powershell!</p> 
  <h3>Powershell GUI</h3> 
  <p>Our first GUI is going to be very simple comprising of a simple form window and a button. This button will use Powershell to get the current date, print it to the STDOUT and close the window.</p> 
  <p>To build the GUI itself, I used the site&nbsp;<a href="https://poshgui.com/Editor" target="_blank" rel="nofollow noopener">POSHGUI</a>. The website allows you to build a GUI online and is surprisingly customisable for a free utility. It allows you to create and customise a lot of Windows Forms objects: TextBox, Button, Label, PictureBox, CheckBox, ComboBox, ListView, ListBox, RadioButton, Panel, Groupbox, MaskedTextBox, ProgressBar and DataGridView. After you have built the GUI you can use the code editor to copy the code used to create the GUI. Most of the code below is copy-and-pasted from this tool, however in later examples I had a lot more experience and thus it became a lot easier to build the GUIs myself without the need of the tool.</p> 
  <pre spellcheck="false">require_relative(<span class="hljs-string">'Powershell.rb'</span>)
  gui=&lt;&lt;END_GUI
      Add-Type -AssemblyName System.Windows.Forms
      [System.Windows.Forms.Application]::EnableVisualStyles()
  
      <span class="hljs-comment">#Create form</span>
      $Form                            = <span class="hljs-keyword">New</span>-Object system.Windows.Forms.Form
      $Form.ClientSize                 = <span class="hljs-string">'228,114'</span>
      $Form.text                       = <span class="hljs-string">"Form"</span>
      $Form.BackColor                  = <span class="hljs-string">"#baffff"</span>
      $Form.TopMost                    = $false
  
      <span class="hljs-comment">#Create button</span>
      $Exit                            = <span class="hljs-keyword">New</span>-Object system.Windows.Forms.Button
      $Exit.BackColor                  = <span class="hljs-string">"#0000ff"</span>
      $Exit.text                       = <span class="hljs-string">"Date and Exit"</span>
      $Exit.width                      = <span class="hljs-number">209</span>
      $Exit.height                     = <span class="hljs-number">82</span>
      $Exit.location                   = <span class="hljs-keyword">New</span>-Object System.Drawing.Point(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>)
      $Exit.Font                       = <span class="hljs-string">'Microsoft Sans Serif,20'</span>
      $Exit.ForeColor                  = <span class="hljs-string">"#ffffff"</span>
  
      <span class="hljs-comment">#Not really required in this but was generated.</span>
      $Form.controls.AddRange(@($Exit))
  
      <span class="hljs-comment">#Add click event on button. Get date, write it to STDOUT, and close form</span>
      $Exit.Add_Click({
          $date = Get-Date
          Write-Host $date
          $form.Close()
      })
  
      <span class="hljs-comment">#Show dialog</span>
      [void]$Form.ShowDialog()
  END_GUI
  
  p Powershell.exec(gui)
  </pre> 
  <p>When running the ruby script we get the following:</p> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="191" width="241" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample1.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample1.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample1.png%2522%252C%2522width%2522%253A241%252C%2522height%2522%253A151%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample1.png%2522%252C%2522width%2522%253A241%252C%2522height%2522%253A151%257D%257D%257D&amp;signature=AUG1VNG7uA0mq5eb_GrY7yevNpMU"></iframe> 
  <p>When the button is clicked, the GUI closes and ruby prints the following Hash to the console:</p> 
  <pre spellcheck="false">{<span class="hljs-symbol">:STDOUT=&gt;<span class="hljs-string">"15/04/2018 20:59:02\n"</span></span>, <span class="hljs-symbol">:STDERR=&gt;<span class="hljs-string">""</span></span>}
  </pre> 
  <p>Hopefully from this small example, you are able to see how easy it can be to make GUIs in Powershell, and how easy it is to intergrate this into your own Ruby scripts as well!</p> 
  <h3>Example 2 - Listview of the currently selected network objects:</h3> 
  <p>Now that we know how to build a simple GUI, let's build something a bit more complex! Let's build a GUI which displays a list view containing all of the selected network objects. The user will then be able to refine his selection further by selecting the objects they want to keep. Upon pressing the OK button, we will return the selected list view items to Ruby, and unselect all network objects which aren't within the user's selection.</p> 
  <p>If the cancel button is clicked we will return the string "Cancel" to Ruby, which Ruby can use to determine when the cancel button was clicked.</p> 
  <pre spellcheck="false">require_relative(<span class="hljs-string">'Powershell.rb'</span>)
  <span class="hljs-keyword">require</span> <span class="hljs-string">'json'</span>
  
  net = WSApplication.current_network
  data = {}
  data[<span class="hljs-string">"head"</span>] =[<span class="hljs-string">"Table name"</span>, <span class="hljs-string">"Object ID"</span>]
  data[<span class="hljs-string">"body"</span>] = []
  selectedItems = []
  
  <span class="hljs-comment">#Get all selected items</span>
  net.table_names.each <span class="hljs-keyword">do</span> <span class="hljs-params">|table|</span>
    selection = net.row_object_collection_selection(table)
    selection.each <span class="hljs-keyword">do</span> <span class="hljs-params">|o|</span>
      data[<span class="hljs-string">"body"</span>].push([table,o.id])
      selectedItems.push(o)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
  
  <span class="hljs-comment">#Build GUI</span>
  gui=&lt;&lt;END_GUI
  <span class="hljs-comment">#Get data from ruby as JSON string</span>
  $data = <span class="hljs-comment">#{data.to_json.to_json.gsub(/\\"/,"\"\"")}</span>
  $data = ConvertFrom-Json $data
  
  
  Add-Type -AssemblyName System.Windows.Forms
  [System.Windows.Forms.Application]<span class="hljs-symbol">::EnableVisualStyles</span>()
  
  <span class="hljs-comment">#region begin GUI{</span>
  
  $Form                            = New-Object system.Windows.Forms.Form
  $Form.ClientSize                 = <span class="hljs-string">'500,400'</span>
  $Form.text                       = <span class="hljs-string">"Form"</span>
  $Form.TopMost                    = $false
  $form.Resize                     = $false
  $form.FormBorderStyle            = <span class="hljs-string">'FixedToolWindow'</span>
  
  $okButton                        = New-Object System.Windows.Forms.Button
  $okButton.text                   = <span class="hljs-string">"OK"</span>
  $okButton.width                  = <span class="hljs-number">150</span>
  $okButton.height                 = <span class="hljs-number">50</span>
  $okButton.location               = New-Object System.Drawing.Point(<span class="hljs-number">96</span>,<span class="hljs-number">330</span>)
  $okButton.Add_Click({
      ForEach($item <span class="hljs-keyword">in</span> $ListView1.SelectedIndices){
          Write-Host $item
      }
      $Form.close()
  })
  
  $cancelButton                    = New-Object System.Windows.Forms.Button
  $cancelButton.text               = <span class="hljs-string">"Cancel"</span>
  $cancelButton.width              = <span class="hljs-number">150</span>
  $cancelButton.height             = <span class="hljs-number">50</span>
  $cancelButton.location           = New-Object System.Drawing.Point(<span class="hljs-number">256</span>,<span class="hljs-number">330</span>)
  $cancelButton.add_click({
    Write-Host <span class="hljs-string">"Cancel"</span>
      $Form.close()
  })
  
  $ListView1                       = New-Object System.Windows.Forms.ListView
  $ListView1.text                  = <span class="hljs-string">"listView"</span>
  $ListView1.width                 = <span class="hljs-number">490</span>
  $ListView1.height                = <span class="hljs-number">300</span>
  $ListView1.location              = New-Object System.Drawing.Point(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>)
  $ListView1.MultiSelect = <span class="hljs-number">1</span>
  $ListView1.View = <span class="hljs-string">'Details'</span>
  $ListView1.FullRowSelect = <span class="hljs-number">1</span>
  $ListView1.Font = <span class="hljs-string">'Microsoft Sans Serif,20'</span>
  
  <span class="hljs-comment">#Generate headers</span>
  ForEach($d <span class="hljs-keyword">in</span> $data.head){
      $col = $ListView1.columns.add($d)
      $col.width = -<span class="hljs-number">2</span>
  }
  
  <span class="hljs-comment">#Generate items</span>
  ForEach($item <span class="hljs-keyword">in</span> $data.body){
      $lvi = New-Object System.Windows.Forms.ListViewItem($item)
      For($i=<span class="hljs-number">1</span>;$i -lt $item.length; $i++){
          [void]$lvi.SubItems.Add($item[$i])
      }
     [void]$ListView1.items.add($lvi)
  }
  
  $Form.controls.AddRange(@($okButton, $cancelButton ,$ListView1))
  
  [void]$Form.ShowDialog()
  END_GUI
  
  <span class="hljs-comment">#Execute Powershell script, display GUI and retrieve user selection.</span>
  guiData = Powershell.exec(gui)
  
  <span class="hljs-comment">#If cancel button was not clicked then...</span>
  <span class="hljs-keyword">if</span> guiData[<span class="hljs-symbol">:STDOUT</span>] != <span class="hljs-string">"Cancel\n"</span>
    <span class="hljs-comment">#Get refined selection from STDOUT</span>
    refinedSelection = guiData[<span class="hljs-symbol">:STDOUT</span>].split(<span class="hljs-string">"\n"</span>).map {<span class="hljs-params">|i|</span> i.to_i}
  
    <span class="hljs-comment">#If object NOT within selected range, unselect it.</span>
    selectedItems.each_with_index <span class="hljs-keyword">do</span> <span class="hljs-params">|o,ind|</span>
      <span class="hljs-keyword">if</span> !(refinedSelection.<span class="hljs-keyword">include</span>? ind)
        o.selected = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
  </pre> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="475" width="518" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample2.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample2.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample2.png%2522%252C%2522width%2522%253A518%252C%2522height%2522%253A435%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample2.png%2522%252C%2522width%2522%253A518%252C%2522height%2522%253A435%257D%257D%257D&amp;signature=AZcYtj5MpdB6oSUxAMbw6PVnokLb"></iframe> 
  <h3>Example 3 - Charting:</h3> 
  <p>Powershell isn't only useful for user input. It can also be used to display statistics and other information to the user through the use of .NET's DataVisualization libraries. In this example we build a GUI containing a bar chart displaying the quantities of model network objects in the current network.</p> 
  <p><strong>Bonus features</strong></p> 
  <p>You can also click on each of the bars to turn them light green. I also added an 'invert' button which inverts all the values in the graph. This helps you click on bars which have small values. I could imagine a GUI like this being used for model review. Maybe you could build a ruby script using the&nbsp;<a href="https://www.linkedin.com/pulse/infoworks-icm-reading-userflags-ruby-james-warren/" target="_blank">WSFlags</a>&nbsp;library and display each of the flags, how often it is used, and it's description...</p> 
  <pre spellcheck="false">require_relative(<span class="hljs-string">'Powershell.rb'</span>)
  
  <span class="hljs-keyword">require</span><span class="hljs-string">'json'</span>
  
  net = WSApplication.current_network
  data = {}
  net.table_names.each <span class="hljs-keyword">do</span> <span class="hljs-params">|table|</span>
    <span class="hljs-keyword">begin</span>
      roc = net.row_object_collection(table)
      roc[<span class="hljs-number">0</span>].system_type
      data[table] = roc.length
    <span class="hljs-keyword">rescue</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
  
  data = data.to_json.to_json.gsub(<span class="hljs-regexp">/\\"/</span>,<span class="hljs-string">"\"\""</span>)
  
  gui=&lt;&lt;END_GUI
  $data = <span class="hljs-comment">#{data}</span>
  
  <span class="hljs-comment">#Parse data to JSON</span>
  $json_data = ConvertFrom-Json $data
  
  <span class="hljs-comment">#Create hash table from object</span>
  $data = @{}
  ForEach($p <span class="hljs-keyword">in</span> $json_data.PSObject.Properties){
      $data[$p.name]=$p.value              
  }
  
  <span class="hljs-comment"># load the appropriate assemblies</span>
  [void][Reflection.Assembly]<span class="hljs-symbol">::LoadWithPartialName</span>(<span class="hljs-string">"System.Windows.Forms"</span>)
  [void][Reflection.Assembly]<span class="hljs-symbol">::LoadWithPartialName</span>(<span class="hljs-string">"System.Windows.Forms.DataVisualization"</span>)
  
  <span class="hljs-comment"># create chart object</span>
  $Chart = New-object System.Windows.Forms.DataVisualization.Charting.Chart
  $Chart.Width = <span class="hljs-number">900</span>
  $Chart.Height = <span class="hljs-number">400</span>
  $Chart.Left = <span class="hljs-number">50</span>
  $Chart.Top = <span class="hljs-number">50</span>
  
  <span class="hljs-comment"># create a chartarea to draw on and add to chart</span>
  $ChartArea = New-Object System.Windows.Forms.DataVisualization.Charting.ChartArea
  $Chart.ChartAreas.Add($ChartArea)
  
  <span class="hljs-comment"># add data to chart</span>
  
  [void]$Chart.Series.Add(<span class="hljs-string">"Data"</span>)
  $Chart.Series[<span class="hljs-string">"Data"</span>].Points.DataBindXY($data.Keys, $data.Values)
  $Chart.ChartAreas[<span class="hljs-number">0</span>].AxisX.Interval = <span class="hljs-number">1</span>
  
  <span class="hljs-comment">#If you don't want a bar chart:</span>
  <span class="hljs-comment">#https://msdn.microsoft.com/en-us/library/system.web.ui.datavisualization.charting.seriescharttype(v=vs.110).aspx</span>
  <span class="hljs-comment">#Use $Chart.Series["Data"].ChartType</span>
  
  $DefaultBarColor = [System.Drawing.Color]<span class="hljs-symbol">::FromArgb</span>(<span class="hljs-number">150</span>,<span class="hljs-number">200</span>,<span class="hljs-number">255</span>)
  $SelectBarColor = [System.Drawing.Color]<span class="hljs-symbol">::FromArgb</span>(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0</span>)
  $Chart.Series[<span class="hljs-string">"Data"</span>].ToolTip = <span class="hljs-string">"#VALX, #VAL"</span>
  $Chart.Series[<span class="hljs-string">"Data"</span>].Color = $DefaultBarColor
  $Chart.Series[<span class="hljs-string">"Data"</span>].BorderColor = [System.Drawing.Color]<span class="hljs-symbol">::FromArgb</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)
  $Chart.Add_Click({  <span class="hljs-comment">#eventArgs =&gt; $_#Get clicked bar</span>
      $result = $chart.HitTest($_.X,$_.Y, $false, [System.Windows.Forms.DataVisualization.Charting.ChartElementType]<span class="hljs-symbol">::DataPoint</span>)
      <span class="hljs-keyword">if</span>($result.Series.Points -ne $null){
          <span class="hljs-comment">#Write-Host $Chart.Series["Data"].Points[$result.PointIndex].AxisLabel#Color as selected:</span>
          foreach($pt <span class="hljs-keyword">in</span> $chart.Series[<span class="hljs-string">"Data"</span>].Points){
              $pt.color = $DefaultBarColor
          }
          $Chart.Series[<span class="hljs-string">"Data"</span>].Points[$result.PointIndex].Color = $SelectBarColor
      }
  })
  
  $button = New-Object Windows.Forms.Button
  $button.Width = <span class="hljs-number">100</span>
  $button.Height = <span class="hljs-number">30</span>
  $button.top = <span class="hljs-number">0</span>
  $button.left = <span class="hljs-number">0</span>
  $button.Text = <span class="hljs-string">"Invert"</span>
  $button.add_click({
    foreach($pt <span class="hljs-keyword">in</span> $Chart.Series[<span class="hljs-string">"Data"</span>].Points){
      $val = $pt.YValues[<span class="hljs-number">0</span>]
      <span class="hljs-keyword">if</span>($val -ne <span class="hljs-number">0</span>){
        $val = <span class="hljs-number">1</span>/$val
      }
      $pt.YValues = @($val)
    }
    $Chart.ChartAreas[<span class="hljs-number">0</span>].RecalculateAxesScale()
  })
  
  
  <span class="hljs-comment"># display the chart on a form, make the chart resize with the form</span>
  $Chart.Anchor = [System.Windows.Forms.AnchorStyles]<span class="hljs-symbol">::Bottom</span> -bor [System.Windows.Forms.AnchorStyles]<span class="hljs-symbol">::Right</span> -bor
                  [System.Windows.Forms.AnchorStyles]<span class="hljs-symbol">::Top</span> -bor [System.Windows.Forms.AnchorStyles]<span class="hljs-symbol">::Left</span>
  $Form = New-Object Windows.Forms.Form
  $Form.Text = <span class="hljs-string">"Model statistics"</span>
  $Form.Width = <span class="hljs-number">1000</span>
  $Form.Height = <span class="hljs-number">500</span>
  $Form.controls.add($Chart)
  $Form.Add_Shown({$Form.Activate()})
  
  
  $Form.controls.AddRange(@($button))
  [void]$Form.ShowDialog()
  END_GUI
  
  Powershell.exec(gui) 
  </pre> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="399" width="744" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample3.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample3.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample3.png%2522%252C%2522width%2522%253A983%252C%2522height%2522%253A483%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F537a8b1eea4171d3b46a88f8566348fe3c1a4cac%252FExample3.png%2522%252C%2522width%2522%253A983%252C%2522height%2522%253A483%257D%257D%257D&amp;signature=AdUC0cim373Ii1CgDsO9gbc_k5OJ"></iframe> 
  <h3>Dynamic Data Transfer</h3> 
  <p>One of the biggest issues with using Powershell is that even though you can input data to the Powershell script before execution, there is no direct method for Powershell to 'have a conversation' with Ruby while it is executing. This is due to the fact that Powershell is an external process. However, that doesn't mean that we can't make our own method of communication that Powershell and Ruby can use!</p> 
  <p>Below are a few examples of systems which could in theory be used to have 'conversations' with other processes:</p> 
  <p><a href="https://gist.github.com/sancarn/00e44231eba3ac20123e10601f236175#windows-message-loop" target="_blank" rel="nofollow noopener"><strong>Windows Message Loop</strong></a></p> 
  <p>Whenever a user interacts with a window, on a machine running Windows OS, the OS sends a message to the window being interacted with. The application displaying the GUI will then take this message, and figure out what it needs to do in response to the message received. Also note that all windows controls (buttons,labels,...) are also windows in their own right. However these windows have special styles and actions depending on the windows messages they receive. For example, when I click on a button, the Windows OS sends the&nbsp;<em>WM_LBUTTONDOWN</em>&nbsp;message to the button, and this will usually cause the button to execute some code. You could imagine it similar to this:</p> 
  <pre spellcheck="false"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myButton</span>.<span class="hljs-title">onMessage</span><span class="hljs-params">(msg,wParam,lParam)</span># <span class="hljs-title">Note</span>:</span> wParam contains buttons being held when clicked, e.g. <span class="hljs-keyword">if</span> control <span class="hljs-keyword">is</span> held, <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span> shift <span class="hljs-keyword">is</span> held, etc.<span class="hljs-comment">#       lParam contains the x and y coordinates of the mouse eventif msg==WM_LBUTTONDOWN#Do something when button is clickedend</span>
  end
  </pre> 
  <p>Powershell you can interact with windows messages sent to a GUI by overriding the&nbsp;<em>WndProc</em>&nbsp;method of the&nbsp;<em>System.Windows.Forms.Form</em>&nbsp;class. This is slightly convoluted and requires C# code. See below:</p> 
  <pre spellcheck="false">$forms = [System.Reflection.Assembly]::LoadWithPartialName(<span class="hljs-string">"System.Windows.Forms"</span>)
  Add-Type -ReferencedAssemblies $forms -TypeDefinition @<span class="hljs-string">"
  using System;
  using System.Windows.Forms;
  using System.Runtime.InteropServices;
  namespace Sancarn
  {
      public class Form1 : Form
      {
          public event EventHandler MessageHandler;
          public Message lastMessage;
  
          public string ptrToString(IntPtr ptr)
          {
              return Marshal.PtrToStringAnsi(ptr);
          }
  
          [System.Security.Permissions.PermissionSet(System.Security.Permissions.SecurityAction.Demand, Name="</span>FullTrust<span class="hljs-string">")]
          protected override void WndProc(ref Message m){
              EventHandler handler = MessageHandler;
              lastMessage = m;
              if(null != MessageHandler) MessageHandler(this,EventArgs.Empty);
              base.WndProc(ref m);
          }
  
  
      }
  }
  "</span>@
  
  
  $WM_USER=<span class="hljs-number">0x0400</span>
  $Tasks   = @()
  $Retvals = @()
  
  $Form = <span class="hljs-keyword">New</span>-Object Sancarn.Form1
  $Form.Text = <span class="hljs-string">"Model statistics"</span>
  $Form.Add_MessageHandler({
      <span class="hljs-keyword">Switch</span>($Form.lastMessage.Msg){
          $WM_USER   {
              <span class="hljs-keyword">if</span>($Tasks.Length -gt <span class="hljs-number">0</span>){
                  $Form.lastMessage.Result = $Tasks.Get(<span class="hljs-number">1</span>)
                  $Tasks.Remove(<span class="hljs-number">1</span>)
              } <span class="hljs-keyword">else</span> {
                  $Form.lastMessage.Result = <span class="hljs-number">0</span>
              }
          }
          $($WM_USER+<span class="hljs-number">1</span>) {
              <span class="hljs-keyword">if</span>($Form.lastMessage.LParam){
                  $Retvals.add([System.Runtime.InteropServices.Marshal]::PtrToStringAnsi($Form.lastMessage.WParam,$Form.lastMessage.LParam))
              } <span class="hljs-keyword">else</span> {
                  $Retvals.add([System.Runtime.InteropServices.Marshal]::PtrToStringAnsi($Form.lastMessage.WParam))
              }
  
          }
      }
  })
  
  [void]$Form.ShowDialog()
  </pre> 
  <p>The Operating System isn't the only process which can send messages. Other applications can too! In fact, Ruby can send messages to any window on the operating system using the&nbsp;<em>SendMessage()</em>&nbsp;and&nbsp;<em>PostMessage()</em>&nbsp;methods. Ruby can therefore continually send messages asking Powershell whether any tasks require completing on the ruby end. After completing the task, Ruby can send another message to Powershell containing the resultant data.</p> 
  <pre spellcheck="false">WM_USER = <span class="hljs-number">0x1000</span>
  <span class="hljs-keyword">while</span> form.isRunning dowhile !(data=SendMessage(powershellWND,WM_USER,<span class="hljs-literal">nil</span>)) doend
      
      <span class="hljs-comment">#Process data and send it back to Powershell</span>
      data = data + <span class="hljs-number">1</span>
      SendMessage(powershellWND,WM_USER+<span class="hljs-number">1</span>,data)
  <span class="hljs-keyword">end</span>
  </pre> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="540" width="744" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-Polling.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-Polling.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-Polling.png%2522%252C%2522width%2522%253A1660%252C%2522height%2522%253A1141%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-Polling.png%2522%252C%2522width%2522%253A1660%252C%2522height%2522%253A1141%257D%257D%257D&amp;signature=AdDf6X-h0sCLvIPMUhwRdP_4dgCg"></iframe> 
  <p>Furthermore, Ruby should be able to process messages sent to an open ICM window before ICM's main process handles the message. It can do this by using&nbsp;<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644936(v=vs.85).aspx" target="_blank" rel="nofollow noopener"><em>GetMessage</em></a>, <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644955(v=vs.85).aspx" target="_blank" rel="nofollow noopener"><em>TranslateMessage</em></a> and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644934(v=vs.85).aspx" target="_blank" rel="nofollow noopener"><em>DispatchMessage</em></a><em>. </em><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644956(v=vs.85).aspx" target="_blank" rel="nofollow noopener"><em>WaitMessage</em></a><em> </em>could also be used and would be ideal, as no polling would be required and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644948(v=vs.85).aspx" target="_blank" rel="nofollow noopener"><em>ReplyMessage</em></a> can be used to return data to the calling process.</p> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="587" width="744" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-EventBased.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-EventBased.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-EventBased.png%2522%252C%2522width%2522%253A1516%252C%2522height%2522%253A1141%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-Messages-EventBased.png%2522%252C%2522width%2522%253A1516%252C%2522height%2522%253A1141%257D%257D%257D&amp;signature=ASFyh9xyVYl8320ElVYHbs_bldws"></iframe> 
  <p>I am yet to test this fully. However it would likely be the best option if it works.</p> 
  <p><strong>Alternative Ruby message handler</strong></p> 
  <p>Theoretically in Ruby version 2 (ICM 8.0+) you should be able to overwrite the WndProc using the following</p> 
  <pre spellcheck="false">WH_CALLWNDPROC = <span class="hljs-number">4</span>
  windowProc = Class.new(Fiddle::Closure) {
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span><span class="hljs-params">(message,wParam,lParam)</span></span><span class="hljs-keyword">if</span> message == WM_USER
        <span class="hljs-comment">#process data</span>
        data = <span class="hljs-number">3</span>
        
        <span class="hljs-comment">#call next hook</span>
        CallNextHookEx.call(<span class="hljs-number">0</span>, message, wParam, lParam)
        <span class="hljs-keyword">return</span> data
      endend
  }.new(Fiddle::TYPE_LONGLONG, [Fiddle::TYPE_LONG,Fiddle::TYPE_LONG,Fiddle::TYPE_LONG])
  
  hook = SetWindowsHookEx.call(WH_CALLWNDPROC,windowProc,<span class="hljs-number">0</span>,GetCurrentThreadId.call())
  </pre> 
  <p><strong>Sockets</strong></p> 
  <p>Sockets are another method of transferring data between 2 applications. Generally speaking, an application registers itself as a server. Then other client applications can use TCP/HTTP requests to ask for certain data. In our case, Ruby would set up a server, and Powershell would make requests for any tasks which require running in ICM.</p> 
  <p>We will revisit this technique in part 2 when we cover HTML GUIs.</p> 
  <p><strong>Pipes</strong></p> 
  <p>Often pipes are also used for inter-process communication. Pipes are special files which are hidden to Windows Explorer. A pipe can be written to by 1 application, and read from by another. By setting up 2 pipes, an input and an output pipe, one can setup a conversation.</p> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="301" width="744" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F017371c385862009482f07e4b32c72c3eed214e5%252FIPC-PipeBased.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F017371c385862009482f07e4b32c72c3eed214e5%252FIPC-PipeBased.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F017371c385862009482f07e4b32c72c3eed214e5%252FIPC-PipeBased.png%2522%252C%2522width%2522%253A1634%252C%2522height%2522%253A582%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F017371c385862009482f07e4b32c72c3eed214e5%252FIPC-PipeBased.png%2522%252C%2522width%2522%253A1634%252C%2522height%2522%253A582%257D%257D%257D&amp;signature=ARVzFeStMzECEHvExx4ZjzdozWx7"></iframe> 
  <p>ICM likely already uses pipes for Ruby scripts, as a pipe named Ruby_&lt;&gt; is created whenever an instance of ICM runs a Ruby script. Unfortunately, I am yet to be able to write to a pipe using Ruby on our system at work, and thus I do not have any working code for this kind of IPC. I believe these operations have been restricted by our IT department.</p> 
  <p><strong>Files</strong></p> 
  <p>This is the final and simplest form of IPC. Ruby and Powershell could each have a file stored in&nbsp;<em>ENV["TEMP"]</em>. We will call these files the&nbsp;<em>IN</em>&nbsp;and&nbsp;<em>OUT</em>&nbsp;files. Each file acts as a conduit for Powershell to transfer information to and receive information from Ruby. When Ruby launches it creates the&nbsp;<em>IN</em>&nbsp;and&nbsp;<em>OUT</em>&nbsp;files and passes the file paths to the Powershell script. Ruby then launches the Powershell script in a new thread, and proceeds to monitor the&nbsp;<em>IN</em>&nbsp;file for changes.</p> 
  <p>If a GUI event occurs which requires a task to be executed in the Ruby environment, then Powershell can write the task to the&nbsp;<em>IN</em>&nbsp;file. Afterwards Powershell begins to monitor the&nbsp;<em>OUT</em>&nbsp;file for changes. Ruby, noticing the&nbsp;<em>IN</em>&nbsp;file has changed, will read the task out of the file, process it and return all outputs to the&nbsp;<em>OUT</em>&nbsp;file. Ruby will then continue to monitor the&nbsp;<em>IN</em> file for further tasks. Powershell, detecting the&nbsp;<em>OUT</em>&nbsp;file has changed, will take the processed data and continue on with it's GUI events as usual. For more information see the diagram below:</p> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="549" width="744" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522image%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522provider%2522%253A%257B%2522url%2522%253A%2522http%253A%252F%252Fgist.githubusercontent.com%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-FileBased.png%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-FileBased.png%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-FileBased.png%2522%252C%2522width%2522%253A1632%252C%2522height%2522%253A1141%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Image%2522%253A%257B%2522url%2522%253A%2522https%253A%252F%252Fgist.githubusercontent.com%252Fsancarn%252F00e44231eba3ac20123e10601f236175%252Fraw%252F86544bdc7888f33544ac5926a65a3cfe40fa1362%252FIPC-FileBased.png%2522%252C%2522width%2522%253A1632%252C%2522height%2522%253A1141%257D%257D%257D&amp;signature=AZE65Tl_IZofF2PHqjSevPYAWBH7"></iframe> 
  <h2>Powershell.rb Improved</h2> 
  <p>To cater for the above data transfer systems I modified the original Powershell class to create a easy-to-access data transfer class&nbsp;<em>DTP</em>. This Ruby library will integrate a <em>DTP</em> class into both Powershell and Ruby. Ultimately, the class allows us to run Ruby code directly from Powershell.</p> 
  <pre spellcheck="false"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Powershell</span><span class="hljs-comment">#exec() will execute any arbitrary powershell script which is not already encoded.def self.exec(data,dtp=false)#If DTP is enabled, launch DTPif dtp</span></span>
        data = <span class="hljs-keyword">self</span>.__dtp_execute(data)
      <span class="hljs-keyword">end</span>
      
      <span class="hljs-comment">#Encoding ensures there'll be no issues with complex quoted datarequire 'base64'</span>
      data = Base64.strict_encode64(data.encode(<span class="hljs-string">"utf-16le"</span>))
      
      <span class="hljs-comment">#Execute encoded commands:require 'win32ole'</span>
      shell = WIN32OLE.new(<span class="hljs-string">"WScript.Shell"</span>)
      
    <span class="hljs-comment">#if (debug) then " -WindowStyle Hidden"</span>
    app = shell.exec(<span class="hljs-string">"powershell -NoProfile -NonInteractive -EncodedCommand \""</span> + data + <span class="hljs-string">"\""</span>)
    sleep(<span class="hljs-number">0</span>.<span class="hljs-number">1</span>) <span class="hljs-keyword">while</span> app.status == <span class="hljs-number">0</span>
      
      <span class="hljs-comment">#If DTP is enabled, close DTPif dtpself.__dtp_exit()end</span>
      
      <span class="hljs-keyword">return</span> {<span class="hljs-symbol">:STDOUT=&gt;app</span>.StdOut.ReadAll(),<span class="hljs-symbol">:STDERR=&gt;app</span>.StdErr.ReadAll()}
    <span class="hljs-keyword">end</span>
  
  
    <span class="hljs-comment">#execEncoded() will execute any arbitrary powershell script which has already been encoded.def self.execEncoded(data)require 'win32ole'</span>
      shell = WIN32OLE.new(<span class="hljs-string">"WScript.Shell"</span>)
      app = shell.exec(<span class="hljs-string">"powershell -NoProfile -NonInteractive -WindowStyle Hidden -EncodedCommand \""</span> + data + <span class="hljs-string">"\""</span>)
      <span class="hljs-keyword">return</span> {<span class="hljs-symbol">:STDOUT=&gt;app</span>.StdOut.ReadAll(),<span class="hljs-symbol">:STDERR=&gt;app</span>.StdErr.ReadAll()}
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-comment">#Initialise DTP. Setup IN and OUT files, and handle changes in seperate threaddef self.__dtp_execute(data)</span>
      @@IN  =  <span class="hljs-string">"<span class="hljs-subst">#{ENV[<span class="hljs-string">"TMP"</span>]}</span>\\IN_<span class="hljs-subst">#{$$}</span>.txt"</span>
      @@OUT =  <span class="hljs-string">"<span class="hljs-subst">#{ENV[<span class="hljs-string">"TMP"</span>]}</span>\\OUT_<span class="hljs-subst">#{$$}</span>.txt"</span>
      dtp=&lt;&lt;-DTP_END
        <span class="hljs-comment"># Called with [DTP]::exec("return ""hello world""")class DTP {</span>
          static [String]$IN  = <span class="hljs-string">"<span class="hljs-subst">#{@@IN}</span>"</span>
          static [String]$OUT = <span class="hljs-string">"<span class="hljs-subst">#{@@OUT}</span>"</span>
          static [String]exec([String]$script) {
            <span class="hljs-comment"># Get data currently in OUT file</span>
            $OLD = (Get-FileHash -Path $([DTP]<span class="hljs-symbol">::OUT</span>)).Hash
            
            <span class="hljs-comment"># Pipe data into IN file</span>
            $script <span class="hljs-params">| Out-File -FilePath $([DTP]::IN) -Encoding ascii
            
            # Wait til OUT file has changed
            <span class="hljs-keyword">while</span>($OLD -eq (Get-FileHash -Path $([DTP]::OUT)).Hash){
              Start-Sleep -Milliseconds 100
            }
            
            # _return OUT data
            <span class="hljs-keyword">return</span> Get-Content -Path $([DTP]::OUT)
          }
        }
      DTP_END
      
      # append data transfer protocol powershell to inputted script
      data = dtp + "\r\n" + data
      
      # setup ruby file monitoring / ruby execution thread.
      File.write(@@IN,"")
      File.write(@@OUT,"")
      @@dtp_thread = Thread.new dowhile <span class="hljs-literal">true</span>
          current = File.read(@@IN).hash
          
          #Poll till change... (<span class="hljs-keyword">in</span> an ideal world we would use win32 api's WaitForObject() here...)
          <span class="hljs-keyword">while</span> current == File.read(@@IN).hash
            sleep(0.1)
          <span class="hljs-keyword">end</span>
          
          #Execute <span class="hljs-keyword">and</span> write data to Powershell
          File.write(@@OUT,eval("lambda <span class="hljs-keyword">do</span>;#{File.read(@@IN)};<span class="hljs-keyword">end</span>.call()"))
        endend
      
      #_ret altered powershell script
      <span class="hljs-keyword">return</span> data
    <span class="hljs-keyword">end</span>
  
    def <span class="hljs-keyword">self</span>.__dtp_exit()
      @@dtp_thread.exit
  
        #Force delete
        <span class="hljs-keyword">require</span> 'win32api'
        fileDelete = Win32API.new("Kernel32.dll","DeleteFile",["p"],"i")
        
        #Force delete <span class="hljs-keyword">in</span> <span class="hljs-keyword">and</span> out files
        fileDelete.call(@@IN)
        fileDelete.call(@@OUT)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
  </span></pre> 
  <p>Ultimately to execute Powershell with the data transfer protocol (<em>DTP</em>) you simply call the exec method as follows:&nbsp;<em>Powershell.exec(myGui,true)</em>. We can execute Ruby scripts in Powershell as follows:&nbsp;<em>[DTP]::exec(someRubyScript)</em>. This method will evaluate the Ruby code and return the results as a string to Powershell.</p> 
  <p>Here's a "hello world" example:</p> 
  <pre spellcheck="false">require_relative(<span class="hljs-string">'Powershell.rb'</span>)
  ps=&lt;&lt;HEREDOC
    <span class="hljs-variable">$a</span> = [DTP]::<span class="hljs-built_in">exec</span>(<span class="hljs-string">'return "hello world"'</span>)
    Write-Host <span class="hljs-variable">$a</span>
  HEREDOC
  p Powershell.exec(ps,<span class="hljs-literal">true</span>)
  </pre> 
  <p>You'll see that the&nbsp;<em>STDOUT</em>&nbsp;is set to&nbsp;hello world&nbsp;as returned by the Ruby VM.</p> 
  <p><strong>NOTE</strong></p> 
  <p>Interestingly, the DTP class can be used to wrap existing ICM APIs also. E.G:</p> 
  <pre spellcheck="false">class WSOpenNetwork {
    <span class="hljs-function"><span class="hljs-title">WSOpenNetwork</span></span>() { <span class="hljs-comment">#Constructor$script = "</span>
        `<span class="hljs-variable">$liveObjects</span>||={}
        <span class="hljs-keyword">if</span> !`<span class="hljs-variable">$liveObjects</span>[:net]
          `<span class="hljs-variable">$liveObjects</span>[:net] = WSApplication.current_network
        end
      <span class="hljs-string">"
  
      [DTP]::exec(<span class="hljs-variable">$script</span>)
    }
    # Property with getter/setter
    hidden <span class="hljs-variable">$_current_timestep</span> = <span class="hljs-variable">$(Accessor $this { get { [DTP]::exec("$liveObjects[:net].current_timestep")</span>
      }
      set {
        param (<span class="hljs-variable">$arg</span>)
        [DTP]::exec("</span><span class="hljs-built_in">return</span> <span class="hljs-variable">$liveObjects</span>[:net].current_timestep=<span class="hljs-variable">$arg</span> rescue <span class="hljs-built_in">return</span> <span class="hljs-string">""</span>ERROR<span class="hljs-string">""</span>;<span class="hljs-string">")
      }
    })
    #...
  }
  
  
  net = [WSOpenNetwork]::new()
  Write-Host net.current_timestep
  net.current_timestep = 10
  Write-Host net.current_timestep
  </span></pre> 
  <p>Utimately, you could quite easily make a full Powershell API for ICM using this method!</p> 
  <h2>Example 4 - Model Database Treeview:</h2> 
  <p>So why do we need the ability to execute ruby scripts from Powershell anyway? The main reason is, optimisation. Take the case that we want to display the Model Database to the user in a tree view. To do this we might think we need a list of all items in the database. One option would be to walk through the entire database and create a hierarchical tree that we can send to Powershell. Something like the following script:</p> 
  <pre spellcheck="false"><span class="hljs-comment">#Time taken: 23.347s (response = 535 model objects, ran immediately after opening Database)</span>
  
  t1 = Time.now
    $dbListPaths=<span class="hljs-string">""</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">walk</span><span class="hljs-params">(moc)</span></span>
      moc.each <span class="hljs-keyword">do</span> <span class="hljs-params">|mo|</span>
        $dbListPaths += mo.path + <span class="hljs-string">"\n"</span>
        walk(mo.children)
      endend
    root_objects = WSApplication.current_database.root_model_objects
    walk(root_objects)
  t2 = Time.now
  puts <span class="hljs-string">"Time taken: <span class="hljs-subst">#{t2-t1}</span>"</span>
  puts $dbListPaths
  </pre> 
  <p>This is great but it's not particularly fast. If we wanted to speed up the process, one option is to use multithreading:</p> 
  <pre spellcheck="false"><span class="hljs-comment">#Time taken: 2.772s (response = 535 model objects, ran immediately after opening Database)</span>
  
  t1 = Time.now
    $threads = []
    $output = File.new(<span class="hljs-string">"U:\\DatabasePaths.txt"</span>,<span class="hljs-string">"w"</span>)
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">walk</span><span class="hljs-params">(moc)</span></span>
      $dbListCounter+=<span class="hljs-number">1</span>
      moc.each <span class="hljs-keyword">do</span> <span class="hljs-params">|mo|</span>
        $output.puts mo.path + <span class="hljs-string">"\n"</span>
        $threads.push(Thread.new{walk(mo.children)})
      <span class="hljs-keyword">end</span>
      $dbListCounter-=<span class="hljs-number">1</span><span class="hljs-keyword">end</span>
    root_objects = WSApplication.current_database.root_model_objects
    walk(root_objects)
    $threads.each <span class="hljs-keyword">do</span> <span class="hljs-params">|t|</span>
      t.join
    <span class="hljs-keyword">end</span>
  t2 = Time.now
  puts <span class="hljs-string">"Time taken: <span class="hljs-subst">#{t2-t1}</span>"</span>
  </pre> 
  <p>However even with multithreading this is pretty slow. For instance, it took roughly 3 seconds to map out a model database containing 535 model objects, and typically we'd be working with larger databases... As an example, if I run the algorithm on our largest database, it took the multithreaded algorithm roughly 79 seconds to scan and map out all 7574 model objects, working out to 0.01s per model object. If we had to do this each time we opened the GUI that would be terrible design!</p> 
  <p>Don't get me wrong, these algorithms are definitely useful, but only really when you are either extracting or searching the database structure. For a GUI it'd be better if we simply get model object's children when we need them. We can determine when we need them, from the&nbsp;<em>TreeViewItem::Expand</em>&nbsp;event. This way, we only react to the user's requests. In this next GUI we will do exactly this!</p> 
  <p>So, let's get dug in and see how this GUI is built!</p> 
  <h3>Implementation Notes</h3> 
  <p>It turns out this GUI was much harder than I initially anticipated!! I also learnt a lot about Powershell that I didn't know when I first set out on this project. So here are some notes about Powershell and implementation details of this GUI and the resulting, polished Powershell library both avaialble in the download.</p> 
  <p><strong>1. Check your Powershell version!</strong></p> 
  <p>It turns out that classes are incompatible with Powershell version 4 and below! This meant the initial DTP implementation wouldn't work. For this reason I have created a&nbsp;Powershell4.rb&nbsp;script as well. Powershell4.rb works in almost exactly the same way as Powershell.rb. The major difference is that&nbsp;<em>DTP_Exec</em>&nbsp;is called instead of&nbsp;<em>[DTP]::exec()</em>.</p> 
  <p><strong>2. Powershell4 cannot deal with tab-indented code</strong></p> 
  <p>This caused about 3 hours of debugging... I could run the script on my Windows 10 computer, but as soon as I tried to run the script in Windows 7, Powershell would just freeze... I assumed this was a version issue, and eventually I found out that if you have tab-indented code Powershell4 simply doesn't execute it. Where as in Powershell5 this issue is fixed. Ultimately, if your Powershell5 code doesn't appear to be running, and your running Powershell4, try to replace all tab indents with spaces instead!</p> 
  <p><strong>3. Use of assemblies in Classes is not allowed unless they are ALREADY LOADED</strong></p> 
  <p>See Issue:&nbsp;<a href="https://github.com/PowerShell/PowerShell/issues/2074" target="_blank" rel="nofollow noopener">Powershell#2074</a>.</p> 
  <p>This caused a massive headache. An example of the current implementation:</p> 
  <pre spellcheck="false">Add-Type -AssemblyName Microsft.ActiveDirectory.Management
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span>
  </span>{
      [Microsoft.ActiveDirectory.Management.ADDomain] $domain;
  }
  </pre> 
  <p>The above code will not run. Why? Because while parsing the script, Powershell thinks that&nbsp;<em>[Microsoft.ActiveDirectory.Management.ADDomain]</em>&nbsp;does not exist. Why? Because at the time when it is parsing the script it hasn't ran&nbsp;<em>Add-Type -AssemblyName Microsft.ActiveDirectory.Management</em>&nbsp;and thus it hasn't loaded the required assembly. The only way to correctly run this is as follows:</p> 
  <pre spellcheck="false">Add-Type -AssemblyName Microsft.ActiveDirectory.Management
  Invoke-Expression @<span class="hljs-string">"
  class Test
  {
      [Microsoft.ActiveDirectory.Management.ADDomain] <span class="hljs-variable">$domain</span>;
  }
  "</span>@
  </pre> 
  <p>In the Powershell.rb class, I can't totally ensure that here-strings&nbsp;<em>@" ... "@</em>&nbsp;are not used, and thus instead we use an encoded command. We decode this string and pipe it to&nbsp;<em>Invoke-Expression&nbsp;</em>as shown in the Powershell code.</p> 
  <p><strong>4. The windows command line has a 32,000 character limit</strong></p> 
  <p>Yep. It turns out you can't just pass a large encoded Powershell script directly to Powershell, even if you are using an encoded command. In theory the encoded command sounds great, however in practice with large scripts it is just not viable due to the 32,000 character limit.</p> 
  <p>Fortunately Powershell has the option to use the command:</p> 
  <pre spellcheck="false">  powershell -Command <span class="hljs-string">"-"</span>
  </pre> 
  <p>This allows Powershell execute the script from <em>STDIN</em> instead of from the command line. Fortunately for us this is extremely simple using the following technique:</p> 
  <pre spellcheck="false"><span class="hljs-built_in">require</span> <span class="hljs-string">'win32ole'</span>
  shell = WIN32OLE.<span class="hljs-keyword">new</span>(<span class="hljs-string">"WScript.Shell"</span>)
  oApp = shell.exec(<span class="hljs-string">'powershell -Command "-"'</span>)
  oApp.STDIN.write(script)
  oApp.STDIN.close()
  <span class="hljs-comment">#Powershell **script** will now execute!</span>
  </pre> 
  <p><strong>5. Powershell scripts have a 12,000 character line limit</strong></p> 
  <p>Yep. It turns out that not only does the command line have a limit to the length of each command, but so does Powershell! Should have seen that one coming... Fortunately for us there is a handy .NET utility called&nbsp;StringBuilder&nbsp;which we can use to build long strings for us.</p> 
  <pre spellcheck="false">$stringBuilder = <span class="hljs-keyword">New</span>-Object System.Text.StringBuilder
  
  <span class="hljs-comment">#Collect data</span>
  [void]$stringBuilder.Append(<span class="hljs-string">"&lt;BASE64&gt;"</span>)
  [void]$stringBuilder.Append(<span class="hljs-string">"&lt;BASE64&gt;"</span>)
  [void]$stringBuilder.Append(<span class="hljs-string">"&lt;BASE64&gt;"</span>)
  
  <span class="hljs-comment">#Output data</span>
  $stringBuilder.toString()
  </pre> 
  <p>Ultimately we use this to build the body out of 5000 character base64 chunks. It is these that we eventually decode and execute.</p> 
  <p><strong>6. DTP - Error handling and Return values</strong></p> 
  <p>If&nbsp;<em>[DTP]::exec()</em>&nbsp;was accidentally fed code which contains syntax errors, or with code that returned no value, there would be no change in the DTP files in the original implementation. Because the files didn't change the application would simply hang. To fix this I've changed the implementation such that data is always returned. The data returned will either be:</p> 
  <ul> 
   <li>The result of the ruby script</li> 
   <li>An Error message (contents of&nbsp;myError.to_s)</li> 
   <li>If the result of the ruby script is blank,&nbsp;[void]&nbsp;is returned.</li> 
  </ul> 
  <p><strong>7. Home testing additions</strong></p> 
  <p>While testing the ruby scripts I was often working on my own laptop. I do not have ICM installed on my laptop, although I have already installed Ruby. Therefore I have added a&nbsp;<em>$debugMode</em>&nbsp;to the script such that whenever&nbsp;<em>WSApplication</em>&nbsp;is not present, debug mode is activated and will still allow me to test the GUI.</p> 
  <p>In the future I'd like to make a ICM Ruby testing framework, which would ultimately emulate the ICM's Ruby API on a specific model database strictly for debugging.</p> 
  <h2>The final treeview script!</h2> 
  <p>So here it is, the script shown in the head of the article and the script I am most proud of. This script will fully emulate the treeviews seen in the ICM Master Database.</p> 
  <pre spellcheck="false"><span class="hljs-keyword">require</span> <span class="hljs-string">'json'</span>
  require_relative(<span class="hljs-string">'Powershell4.rb'</span>)
  $imageList = [
      <span class="hljs-comment">#IMAGE DATA IS STORED HERE;#REMOVED FOR THE PURPOSE OF THE ARTICLE.</span>
  ]
  
  <span class="hljs-comment">#Automatically activate debug mode if WSApplication doesn't exist. In future we will want to require WSApplication (ICMTestAPI)</span>
  WSApplication ||= nil
  <span class="hljs-keyword">if</span> !WSApplication
      $debugMode = <span class="hljs-keyword">true</span>
  <span class="hljs-keyword">else</span>
      $debugMode = <span class="hljs-keyword">false</span>
  end
  
  <span class="hljs-comment">#Debug mode ==&gt; No ICM ==&gt; Need to create root objects</span>
  <span class="hljs-keyword">if</span> $debugMode
      arr = [
          {:id =&gt;  <span class="hljs-number">1</span>, :name =&gt; <span class="hljs-string">"Model"</span>      , :type =&gt; <span class="hljs-string">"MODEL GROUP"</span>   , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">0</span>},
          {:id =&gt;  <span class="hljs-number">2</span>, :name =&gt; <span class="hljs-string">"Runs"</span>       , :type =&gt; <span class="hljs-string">"MODEL GROUP"</span>   , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">0</span>},
          {:id =&gt;  <span class="hljs-number">3</span>, :name =&gt; <span class="hljs-string">"Brooksfield"</span>, :type =&gt; <span class="hljs-string">"MODEL NETWORK"</span> , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">1</span>},
          {:id =&gt;  <span class="hljs-number">4</span>, :name =&gt; <span class="hljs-string">"Overflows"</span>  , :type =&gt; <span class="hljs-string">"SELECTION LIST"</span>, :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">1</span>},
          {:id =&gt;  <span class="hljs-number">5</span>, :name =&gt; <span class="hljs-string">"Asset data"</span> , :type =&gt; <span class="hljs-string">"LAYER LIST"</span>    , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">1</span>},
          {:id =&gt;  <span class="hljs-number">6</span>, :name =&gt; <span class="hljs-string">"Pipe sizes"</span> , :type =&gt; <span class="hljs-string">"THEME"</span>         , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">1</span>},
          {:id =&gt;  <span class="hljs-number">7</span>, :name =&gt; <span class="hljs-string">"DWF"</span>        , :type =&gt; <span class="hljs-string">"RUN"</span>           , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">2</span>},
          {:id =&gt;  <span class="hljs-number">8</span>, :name =&gt; <span class="hljs-string">"DWF-CAB"</span>    , :type =&gt; <span class="hljs-string">"SIM"</span>           , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">7</span>},
          {:id =&gt;  <span class="hljs-number">9</span>, :name =&gt; <span class="hljs-string">"DWF-KST"</span>    , :type =&gt; <span class="hljs-string">"SIM"</span>           , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">7</span>},
          {:id =&gt; <span class="hljs-number">10</span>, :name =&gt; <span class="hljs-string">"DWF-PLT"</span>    , :type =&gt; <span class="hljs-string">"SIM"</span>           , :<span class="hljs-keyword">parent</span> =&gt; <span class="hljs-number">7</span>}
      ]
      rootObjects = arr.to_json.to_json.gsub(/\\<span class="hljs-string">"/,'""') #"</span>
  <span class="hljs-keyword">else</span>
      iwdb = WSApplication.current_database
      arr = []
      iwdb.root_model_objects.each <span class="hljs-keyword">do</span> |child|
          arr.push({
              :name=&gt;child.name,
              :id=&gt;child.id,
              :type=&gt;child.type.upcase,
              :<span class="hljs-keyword">parent</span>=&gt;child.parent_id
          })
      end
      rootObjects = arr.to_json.to_json.gsub(/\\<span class="hljs-string">"/,'""') #"</span>
  
  end
  
  header=&lt;&lt;ENDHEADER
      Add-Type -AssemblyName System.Drawing
      Add-Type -AssemblyName System.Windows.Forms
      $global:debugMode = $<span class="hljs-comment">#{$debugMode}</span>
  ENDHEADER
  
  gui =&lt;&lt;GUIEND
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addModelObject</span><span class="hljs-params">($obj)</span></span>{
      $parent = [System.Windows.Forms.TreeNode]$global:database.Item($obj.<span class="hljs-keyword">parent</span>)
      $node = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.TreeNode
      $node.text = $obj.name
      $node.Tag  = $obj
      $node.ImageKey = $obj.type
      $node.SelectedImageKey = $obj.type
      $parentTypes=@(<span class="hljs-string">"MODEL GROUP"</span>,<span class="hljs-string">"MASTER GROUP"</span>,<span class="hljs-string">"RUN"</span>)
      <span class="hljs-keyword">if</span>($parentTypes.contains($obj.type)){
          <span class="hljs-keyword">if</span>(!$global:debugMode){
              <span class="hljs-comment">#add dummy child</span>
              $in = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.TreeNode
              $in.text = <span class="hljs-string">"4e84b5c3-1864-4e51-9381-6405f9d68faf"</span>
              [void]$node.nodes.add($in)
          }
      }
  
      [void]$parent.nodes.add($node)
      [void]$global:database.add($obj.id,$node)
  }
  
  
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IWDBGetChildren</span><span class="hljs-params">([System.Windows.Forms.TreeNode]$node)</span> </span>{
      $cmd = <span class="hljs-string">"
          require 'json'
          iwdb = WSApplication.current_database
          mo = iwdb.model_object_from_type_and_id(""$($node.tag.type)"",$($node.tag.id))
          arr = []
          mo.children.each do |child|
              arr.push({
                  :name=&gt;child.name,
                  :id=&gt;child.id,
                  :type=&gt;child.type.upcase,
                  :parent=&gt;child.parent_id
              })
          end
          return arr.to_json
      "</span><span class="hljs-keyword">return</span> ConvertFrom-Json $(DTP_exec $cmd)
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RBGetImageData</span><span class="hljs-params">()</span></span>{
      $cmd = <span class="hljs-string">"
          require 'json'
          return `$imageList.to_json
      "</span><span class="hljs-keyword">return</span> ConvertFrom-Json $(DTP_exec $cmd)
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getImage</span><span class="hljs-params">($data)</span></span>{
      [void]($data -match <span class="hljs-string">"data:image/(?&lt;type&gt;.+?),(?&lt;data&gt;.+)"</span>)
      $b64Data = $Matches.data
      $binData = [System.Convert]::FromBase64String($b64Data)
      $stream = <span class="hljs-keyword">New</span>-Object System.IO.MemoryStream($binData,<span class="hljs-number">0</span>,$binData.Length)
      $image = [System.Drawing.Image]::FromStream($stream,$true)
      $image.MakeTransparent(<span class="hljs-number">0</span>) <span class="hljs-comment">#ICM Images appear to use Black background as transparency. Here we make this color transparent.return $image</span>
  }
  
  <span class="hljs-comment"># Get image list from ruby ---&gt; Note:  Can't send in through command line as is too large.</span>
  $imgs = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.ImageList
  <span class="hljs-keyword">ForEach</span>($type in $(RBGetImageData)){
      $imgs.Images.add($type.name,[System.Drawing.Image]$(getImage $($type.data)))
  }
  $size = <span class="hljs-keyword">New</span>-Object System.Drawing.Size
  $size.Width=<span class="hljs-number">26</span>
  $size.Height=<span class="hljs-number">26</span>
  $imgs.ImageSize = $size
  
  <span class="hljs-comment">#FORM CONTROLS</span>
  $form = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.Form
  $form.Width = <span class="hljs-number">490</span>
  $form.Height = <span class="hljs-number">400</span>
  $form.FormBorderStyle = <span class="hljs-string">"Fixed3d"</span>
  $form.MaximizeBox = $false
  
  $treeView1 = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.TreeView
  $treeView1.Name = <span class="hljs-string">"treeView1"</span>
  $treeView1.Width = <span class="hljs-number">450</span>
  $treeView1.Height = <span class="hljs-number">300</span>
  $treeView1.top = <span class="hljs-number">10</span>
  $treeView1.left = <span class="hljs-number">10</span>
  $treeView1.Font = <span class="hljs-string">'Microsoft Sans Serif,14'</span>
  $treeView1.DataBindings.DefaultDataSourceUpdateMode = <span class="hljs-number">0</span>
  $treeView1.TabIndex = <span class="hljs-number">0</span>
  $treeView1.HideSelection = $false
  $treeView1.ImageList = $imgs
  $treeView1.ShowRootLines = $true
  
  $okButton = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.Button
  $okButton.width = <span class="hljs-number">100</span>
  $okButton.height = <span class="hljs-number">30</span>
  $okButton.top = <span class="hljs-number">310</span>
  $okButton.left = <span class="hljs-number">10</span>
  $okButton.text = <span class="hljs-string">"OK"</span>
  
  <span class="hljs-comment">#GUI EVENTS</span>
  $treeView1.add_BeforeExpand({
      $node = [System.Windows.Forms.TreeNode]$_.Node
      <span class="hljs-keyword">if</span>(!$global:debugMode){
          <span class="hljs-keyword">if</span>($node.tag.id -ne <span class="hljs-number">0</span>){
              <span class="hljs-number">1.</span>.$node.Nodes.count | % {$node.Nodes.RemoveAt(<span class="hljs-number">0</span>)}
              $children = IWDBGetChildren $node
              <span class="hljs-keyword">ForEach</span>($child in $children){
                  addModelObject $child
              }
          }
      }
  })
  $treeView1.add_KeyDown({
      <span class="hljs-keyword">if</span> ($_.KeyCode -eq <span class="hljs-string">'Enter'</span>){
          $okButton.PerformClick()
      }
  })
  $okButton.add_click({
      $json = ConvertTo-Json $($treeView1.SelectedNode.Tag)
      Write-Host $json
      $form.close()
  })
  
  <span class="hljs-comment">#SETUP GLOBAL DATABASE AND ROOT TREE NODE OBJECT</span>
  $global:database = @{}
  $root = <span class="hljs-keyword">New</span>-Object System.Windows.Forms.TreeNode
  $root.text = <span class="hljs-string">"Master Database"</span>
  $root.Name = <span class="hljs-string">"Master Database"</span>
  $root.Tag  = [PSCustomObject]@{
      name=<span class="hljs-string">"Master Database"</span>
      id=<span class="hljs-number">0</span>
      type=<span class="hljs-string">"root"</span>
  }
  [void]$treeView1.Nodes.add($root)
  [void]$global:database.Add(<span class="hljs-number">0</span>,$root)
  
  <span class="hljs-comment">#INSTANTIATE ROOT OBJECTS</span>
  $rootObjects = <span class="hljs-comment">#{rootObjects}</span>
  $rootObjects = ConvertFrom-Json $rootObjects
  <span class="hljs-keyword">ForEach</span>($obj in $rootObjects){
      addModelObject $obj
  }
  
  <span class="hljs-comment">#SHOW DIALOG</span>
  [void]$form.Controls.Add($treeView1)
  [void]$form.Controls.Add($okButton)
  [void]$Form.ShowDialog()
  GUIEND
  
  data = Powershell4.exec(gui,<span class="hljs-keyword">true</span>,header)
  <span class="hljs-comment">#p data</span>
  <span class="hljs-keyword">if</span> data[:STDOUT]!=<span class="hljs-string">""</span>
      moSelected = JSON.parse(data[:STDOUT])
      <span class="hljs-keyword">if</span> !WSApplication
          p moSelected
      <span class="hljs-keyword">else</span>
          WSApplication.message_box(<span class="hljs-string">"Name: #{moSelected["</span>name<span class="hljs-string">"]},\nType: #{moSelected["</span>type<span class="hljs-string">"]},\nID  : #{moSelected["</span>id<span class="hljs-string">"]}"</span>,<span class="hljs-string">'OK'</span>,<span class="hljs-string">'Information'</span>,<span class="hljs-keyword">false</span>)
      end
  <span class="hljs-keyword">else</span>
      puts <span class="hljs-string">"No item selected"</span>
  end
  </pre> 
  <p>I've snipped out the image data of the model objects from the script for the purposes of this article, however you can find the full Powershell script in the GIST download below. In the long run, I think a Powershell class for an ICM treeview would be incredibly helpful. However it'd only be helpful in Powershell 5+, which is somewhat concerning. Alternatively a C# class could be created and imported into Powershell via&nbsp;<em>Add-Type</em>, although interacting with Powershell variables from C# is often complicated...</p> 
  <p>The last option is that a ruby framework could be made to wrap the Powershell Windows Forms libraries. I could imagine a system being created such that someone could write a few lines of Ruby to do all of the above script...</p> 
  <pre spellcheck="false"><span class="hljs-keyword">require</span> <span class="hljs-string">'System.Windows.Forms.rb'</span>
  form = Forms::Form.<span class="hljs-keyword">new</span>()
  form.size = {w:<span class="hljs-number">300</span>,h:<span class="hljs-number">450</span>}
  treeView = Forms::DBView.<span class="hljs-keyword">new</span>()
  treeView.location = {x:<span class="hljs-number">10</span>,y:<span class="hljs-number">10</span>}
  treeView.size = {w:<span class="hljs-number">280</span>,h:<span class="hljs-number">400</span>}
  button = Forms::Button.<span class="hljs-keyword">new</span>()
  button.location = {x:<span class="hljs-number">10</span>,y:<span class="hljs-number">420</span>}
  button.size = {w:<span class="hljs-number">100</span>,h:<span class="hljs-number">30</span>}
  
  form.addControls([treeView,button])
  form.show()
  p treeView.selectedItem
  </pre> 
  <p>But, for now, that's just another possible project for the future!</p> 
  <h2>CONCLUSION</h2> 
  <p>In conclusion, Powershell is an extremely rich and powerful resource for the creation of GUIs in Ruby. It is possible to interact dynamically with Ruby through several data transfer protocols, including those demonstrated in the Powershell library included in this article.</p> 
  <h3><strong>PROS</strong></h3> 
  <ul> 
   <li>Access to all functionality provided by the Microsoft .NET framework.</li> 
   <li>You can also execute C#.NET and VB.NET code from Powershell.</li> 
  </ul> 
  <h3>CONS</h3> 
  <ul> 
   <li>Powershell console is often visible while launching script and displaying the GUI. Ultimately this technique is not very seemless, but it gets the job done. (N.B There may be ways to circumvent this issue using&nbsp;<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx" target="_blank" rel="nofollow noopener">CreateProcess</a>)</li> 
   <li>Somewhat complicated method of launching Powershell due to limitations in command line and Powershell.</li> 
   <li>Powershell is less often used for this purpose, thus most GUI knowledge will come from hunting for C# sample code and porting the code to Powershell.</li> 
  </ul> 
  <p>A download is available for all material in this article:</p> 
  <p><a href="https://gist.github.com/sancarn/00e44231eba3ac20123e10601f236175/archive/74a3301574e115982abc9f0152db130368288f0e.zip" target="_blank" rel="nofollow noopener">DOWNLOAD</a></p> 
  <p>Finally, here's a demo of the project:</p> 
  <iframe class="center" frameborder="0" allowfullscreen="true" src="about:blank" height="419" width="744" data-li-src="https://www.linkedin.com/pulse/api/edit/embed?embed=%257B%2522type%2522%253A%2522video%2522%252C%2522title%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522Powershell%2520GUIs%2520from%2520Ruby%2522%257D%257D%252C%2522description%2522%253A%257B%2522localized%2522%253A%257B%2522en_US%2522%253A%2522%2522%257D%257D%252C%2522author%2522%253A%257B%2522name%2522%253A%2522Sancarn%2522%257D%252C%2522provider%2522%253A%257B%2522name%2522%253A%2522YouTube%2522%252C%2522display%2522%253A%2522YouTube%2522%252C%2522url%2522%253A%2522https%253A%252F%252Fwww.youtube.com%252F%2522%257D%252C%2522request%2522%253A%257B%2522originalUrl%2522%253A%2522https%253A%252F%252Fwww.youtube.com%252Fwatch%253Fv%253DxwodAsdOyl4%2522%252C%2522finalUrl%2522%253A%2522https%253A%252F%252Fwww.youtube.com%252Fwatch%253Fv%253DxwodAsdOyl4%2522%257D%252C%2522images%2522%253A%255B%257B%2522url%2522%253A%2522https%253A%252F%252Fi.ytimg.com%252Fvi%252FxwodAsdOyl4%252Fhqdefault.jpg%2522%252C%2522width%2522%253A480%252C%2522height%2522%253A360%257D%252C%257B%2522url%2522%253A%2522https%253A%252F%252Fi.ytimg.com%252Fvi%252FxwodAsdOyl4%252Fmaxresdefault.jpg%2522%252C%2522width%2522%253A1280%252C%2522height%2522%253A720%257D%255D%252C%2522data%2522%253A%257B%2522com.linkedin.treasury.Video%2522%253A%257B%2522html%2522%253A%2522%253Ciframe%2520scrolling%253D%255C%2522no%255C%2522%2520allowfullscreen%2520src%253D%255C%2522%252F%252Fmedia.licdn.com%252Fembeds%252Fmedia.html%253Fsrc%253Dhttps%25253A%25252F%25252Fwww.youtube.com%25252Fembed%25252FxwodAsdOyl4%25253Ffeature%25253Doembed%2526amp%253Burl%253Dhttps%25253A%25252F%25252Fwww.youtube.com%25252Fwatch%25253Fv%25253DxwodAsdOyl4%2526amp%253Btype%253Dtext%25252Fhtml%2526amp%253Bschema%253Dyoutube%255C%2522%2520width%253D%255C%2522480%255C%2522%2520frameborder%253D%255C%25220%255C%2522%2520class%253D%255C%2522embedly-embed%255C%2522%2520height%253D%255C%2522270%255C%2522%253E%253C%252Fiframe%253E%2522%252C%2522width%2522%253A480%252C%2522height%2522%253A270%257D%257D%257D&amp;signature=Ads65fK0VoOMVYXabXgWkhBEXo8o"></iframe> 
  <p><br></p></div>
  
  <!---->
  <iframe id="reader-article-content__chartbeat-iframe" class="reader-article-content__chartbeat-iframe"></iframe>
  </div>
  
        <div class="reader-flag-content__wrapper mb4 clear-both" data-ember-action="" data-ember-action-1270="1270">
          <a href="#" class="reader-flag-content" data-control-name="report">
            Report this
          </a>
        </div>
  
  <!---->
  <!---->        <div class="social-detail">
            <div id="ember1280" class="reader-social-details clear-both ember-view">    <section data-control-name="likes" id="ember1282" class="feed-shared-likes-list reader-social-details__likes-list ember-view">  <h3 class="feed-shared-likes-list__header t-16 t-black t-normal mt4 mh0 mb2">
        36 Likes
    </h3>
    <ul class="feed-shared-likes-list__list">
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/rob-warren/" id="ember1285" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1286" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1287" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Rob Fawkes (Warren)" id="ember1288" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Rob Fawkes (Warren)</span>
  </div>
  
  <div id="ember1289" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/salvatore-perfetto-a576036b/" id="ember1291" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1292" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1293" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Salvatore Perfetto" id="ember1294" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Salvatore Perfetto</span>
  </div>
  
  <div id="ember1295" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/awhitmore1/" id="ember1297" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1298" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1299" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Adam Whitmore" id="ember1300" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Adam Whitmore</span>
  </div>
  
  <div id="ember1301" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/richardbaileyqa/" id="ember1303" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1304" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1305" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Richard Bailey" id="ember1306" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Richard Bailey</span>
  </div>
  
  <div id="ember1307" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator hidden presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is offline
    </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/juangutierrezandres/" id="ember1309" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1310" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1311" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Juan Gutierrez Andres" id="ember1312" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Juan Gutierrez Andres</span>
  </div>
  
  <div id="ember1313" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/wongwatana-sombunying-93188555/" id="ember1315" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1316" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1317" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Wongwatana Sombunying" id="ember1318" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Wongwatana Sombunying</span>
  </div>
  
  <div id="ember1319" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/zewei-chen-b1405377/" id="ember1321" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1322" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1323" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Zewei Chen" id="ember1324" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Zewei Chen</span>
  </div>
  
  <div id="ember1325" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator hidden presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is offline
    </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/yi-chen-b72a1785/" id="ember1327" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1328" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1329" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Yi Chen" id="ember1330" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Yi Chen</span>
  </div>
  
  <div id="ember1331" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator hidden presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is offline
    </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/tomgodman/" id="ember1333" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1334" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1335" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Tom Godman C.WEM" id="ember1336" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Tom Godman C.WEM</span>
  </div>
  
  <div id="ember1337" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item ml2">
  <a data-control-name="like_actor" href="/in/mritunjay-mallik-ceng-mie-india-077b1b61/" id="ember1478" class="feed-shared-likes-list__list-item--profile-link tap-target ember-view">          <div id="ember1479" class="feed-shared-likes-list__list-item--actor-image feed-shared-avatar-image b0 member ember-view">  <div id="ember1480" class="presence-entity presence-entity--size-3 ember-view">  <div aria-label="Mritunjay Mallik CEng, MIE (India)" id="ember1481" class="avatar member EntityPhoto-circle-3 presence-entity__image EntityPhoto-circle-3 ghost-person ember-view">  <span class="visually-hidden">Mritunjay Mallik CEng, MIE (India)</span>
  </div>
  
  <div id="ember1482" class=" presence-entity__indicator presence-entity__indicator--size-3 presence-indicator presence-indicator--is-reachable presence-indicator--size-3 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>      </li>
        <li class="feed-shared-likes-list__list-item--left feed-shared-likes-list__list-item EntityPhoto-circle-3 t-14 t-black--light t-normal ml2">
          <button data-control-name="likes" class="feed-shared-likes-list__likes-left-button" aria-label="See more likes" data-ember-action="" data-ember-action-1338="1338">
            +26
          </button>
        </li>
    </ul>
  </section>
  
  <div id="ember1339" class="reader-social-details__likes-modal ember-view"><div id="ember1340" class="ember-view"><!----></div></div>
  
  <div class="reader-social-details__comments pt4">
  
      <div class="relative">
        <h3 class="reader-social-details__comments-header t-16 t-black t-bold mr5">
          <span aria-hidden="true">
            5 Comments
          </span>
          <span class="visually-hidden">
            Comments on James Warren’s article
          </span>
        </h3>
          <div id="ember1341" class="ember-view"><button class="reader-comments-settings__gear" data-ember-action="" data-ember-action-1342="1342" data-ember-action-1343="1343" data-ember-action-1344="1344">
    <span class="a11y-text">Comments settings</span>
    <li-icon aria-hidden="true" type="gear-icon" class="comments-settings__gear-icon" size="small"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M8,6a2,2,0,1,0,2,2A2,2,0,0,0,8,6ZM8,9.13A1.13,1.13,0,1,1,9.13,8,1.13,1.13,0,0,1,8,9.13Zm5.36-1.49L15,6.12,13.12,2.88,11,3.54l-0.15,0a0.5,0.5,0,0,1-.49-0.39L9.88,1H6.12L5.64,3.17a0.5,0.5,0,0,1-.49.39L5,3.54,2.88,2.88,1,6.12,2.64,7.63a0.5,0.5,0,0,1,0,.74L1,9.88l1.88,3.25L5,12.46l0.15,0a0.5,0.5,0,0,1,.49.39L6.12,15H9.88l0.49-2.17a0.5,0.5,0,0,1,.49-0.39l0.15,0,2.12,0.66L15,9.88,13.36,8.37A0.5,0.5,0,0,1,13.36,7.63Zm-1.1,1.93,0.68,0.63-0.58,1-0.88-.28a2.12,2.12,0,0,0-2.71,1.56l-0.2.9H7.42l-0.2-.9a2.12,2.12,0,0,0-2.71-1.56l-0.88.28-0.58-1,0.68-.63a2.13,2.13,0,0,0,0-3.12L3.06,5.81l0.57-1L4.52,5.09A2.12,2.12,0,0,0,7.22,3.53l0.2-.9H8.58l0.2,0.9a2.12,2.12,0,0,0,2.71,1.56l0.88-.28,0.57,1-0.68.63A2.13,2.13,0,0,0,12.26,9.56Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
    <span class="reader-comments-settings__tooltip tooltip " role="tooltip">
      Comments settings
    </span>
  </button>
  
  <!---->
  <div id="ember1345" class="ember-view"><div id="ember1346" class="ember-view"><!----></div></div>
  </div>
      </div>
  
        <div data-scroll-name="comments-anchor" id="ember1347" class="comments-comment-box reader-social-details__comment-box comments-comment-box--has-avatar ember-view">  <div id="ember1348" class="comments-comment-box__avatar-image ml0 feed-shared-avatar-image b0 member ember-view">  <img src="https://media.licdn.com/dms/image/C4D03AQFfVgF30oZvdQ/profile-displayphoto-shrink_100_100/0?e=1558569600&amp;v=beta&amp;t=F4wi7Isd9ehp8LMkdmOSE-E_V0ZNiML8z95rh_OrIGE" class="avatar member EntityPhoto-circle-2" alt="James Warren">
  </div>
  
  <div class="comments-comment-box__form-container flex-grow-1">
  <!---->  <form class="comments-comment-box__form" data-submit-control-name="comment_post" data-ember-action="" data-ember-action-1349="1349">
      <div class="comments-comment-texteditor full-width display-flex">
        <div data-control-name="comment" id="ember1350" class="comments-comment-mentions-texteditor full-width mentions-texteditor ember-view"><span class="visually-hidden" id="sharing-label">Add a comment…</span>
  <div contenteditable="true" class="mentions-texteditor__contenteditable t-18 t-black--light t-normal" role="textbox" aria-multiline="true" aria-labelledby="sharing-label"><p class="mentions-texteditor__content"><br></p></div>
  <div class="mentions-texteditor__placeholder t-18 t-black--light t-normal relative" data-placeholder="Add a comment…"></div>
  
  <div id="ember1351" class="ember-view"><!----></div>
  </div>
            <div id="ember1352" class="comments-comment-box__camera-icon button sharing-share-action-media tap-target sharing-subaction-bar__photo-button ember-view"><label for="ember1352-upload-photo" class="sharing-share-action-media__upload-input-label
    ">
  
    <li-icon aria-hidden="true" type="camera-icon" class="sharing-share-action-media__upload-camera-icon" size="large"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M21,6H18L16.5,3h-9L6,6H3A1,1,0,0,0,2,7V19a1,1,0,0,0,1,1H21a1,1,0,0,0,1-1V7A1,1,0,0,0,21,6ZM7.36,8l1.5-3h6.28l1.5,3H20v2H16.58a5,5,0,0,0-9.16,0H4V8H7.36Zm7.76,4A3.13,3.13,0,1,1,12,8.88,3.13,3.13,0,0,1,15.13,12ZM4,18V11H7.1a5,5,0,1,0,9.8,0H20v7H4Z" class="large-icon" style="fill: currentColor"></path></svg></li-icon>
  
    <span class="sharing-subaction-bar__button-text">
      Images
    </span>
  </label>
  <input filecountlimit="9" multiple="" name="file" camera="camera" accept="image/*" title="Share Images" id="ember1352-upload-photo" class="sharing-share-action-media__upload-input ember-text-field ember-view" type="file">
  </div>
      </div>
  
  <!---->
  <!---->  </form>
  </div>
  </div>
  
      <div id="ember1354" class="comments-comments-list reader-social-details__comments-list ember-view"><!---->
        <article data-id="urn:li:comment:(article:8008759920368445702,6404346298455113729)" tabindex="-1" id="ember1356" class="comments-comments-list__comment-item comments-comment-item ember-view">    <div class="comments-comment-item__options">
      <time class="comments-comment-item__timestamp t-12 t-black--light t-normal">10mo</time>
  
      <artdeco-dropdown id="ember1357" class="ember-view"><artdeco-dropdown-trigger aria-expanded="false" role="button" placement="bottom" tabindex="0" id="ember1358" class="comment-options-trigger ember-view">    <li-icon type="ellipsis-horizontal-icon" size="small" role="img" aria-label="Open options for Adam Whitmore’s comment"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M2,7H4V9H2V7ZM7,9H9V7H7V9Zm5-2V9h2V7H12Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
  
  <!----></artdeco-dropdown-trigger><artdeco-dropdown-content justification="left" placement="bottom" data-dropdown="" tabindex="-1" aria-hidden="true" id="ember1359" class="dropdown-options ember-view"><!---->
  </artdeco-dropdown-content></artdeco-dropdown>
  <div id="ember1360" class="ember-view"><div id="ember1361" class="ember-view"><!----></div></div>
  
  
  <!---->  </div>
  
  <div id="ember1362" class="comments-comment-item__post-meta feed-shared-post-meta is-comment feed-shared-post-meta--is-not-sponsored ember-view"><a data-control-name="comment_actor" target="_self" href="/in/awhitmore1/" id="ember1363" class="tap-target feed-shared-post-meta__actor-link ember-view">    <div data-entity-hovercard-id="urn:li:fs_miniProfile:ACoAABGGzAUBvYFV656hJIfdwYectILh2nFC4xs" id="ember1364" class="feed-shared-avatar-image b0 member ember-view">  <div id="ember1365" class="presence-entity presence-entity--size-2 ember-view">  <div aria-label="Adam Whitmore" id="ember1366" class="avatar member EntityPhoto-circle-2 presence-entity__image EntityPhoto-circle-2 ghost-person ember-view">  <span class="visually-hidden">Adam Whitmore</span>
  </div>
  
  <div id="ember1367" class=" presence-entity__indicator presence-entity__indicator--size-2 presence-indicator presence-indicator--is-reachable presence-indicator--size-2 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>
  <a data-control-name="comment_actor" target="_self" href="/in/awhitmore1/" id="ember1368" class="feed-shared-post-meta__profile-link t-16 t-black t-bold tap-target ember-view">  <h3 class="feed-shared-post-meta__actor t-12 t-black--light t-normal">
      <span class=" feed-shared-post-meta__name t-14 t-black t-bold">
          <span class="hoverable-link-text" data-entity-hovercard-id="urn:li:fs_miniProfile:ACoAABGGzAUBvYFV656hJIfdwYectILh2nFC4xs">Adam Whitmore</span><!---->          <span id="ember1369" class="feed-shared-post-meta__distance-badge distance-badge separator ember-view">  <span class="visually-hidden">1st degree connection</span>
  
  <span class="dist-value">1st</span>
  </span>
          <!---->    </span>
        <span class="feed-shared-post-meta__headline t-12 t-black--light t-normal">
          Professional Services Consultant
        </span>
  <!----><!----><!----><!----><!----></h3>
  </a>
  <!----></div>
  
  <div class="comments-comment-item-content-body">
  <div id="ember1370" class="ember-view"><div id="ember1371" class="comments-comment-item__inline-show-more-text feed-shared-inline-show-more-text ember-view">          <p dir="ltr" id="ember1372" class="comments-comment-item__main-content feed-shared-main-content--comment t-12 t-black t-normal feed-shared-main-content ember-view"><span id="ember1374" class="ember-view"><span>Very interesting article James, thanks for sharing.</span></span><!----></p>
  <!----></div><!----><!---->
  </div></div>
  
  <div id="ember1376" class="ember-view"><!----></div>
      <div class="comments-comment-item__social-actions ">
        <div id="ember1377" class="comments-comment-social-bar display-flex ember-view"><div class="comments-comment-social-bar__action-group "><button data-control-name="comment_like_toggle" aria-pressed="true" aria-label="Like Adam Whitmore’s comment" id="ember1378" class="comments-comment-social-bar__action-button t-12 t-black--light t-bold pr3 ml0 hoverable-link-text like-button button like active ember-view"><!---->
    <span aria-hidden="true">Like</span>
  
  <span class="visually-hidden">
        Unlike Adam Whitmore’s comment
  </span>
  
  </button><button data-control-name="reply" id="ember1379" class="comments-comment-social-bar__action-button t-12 t-black--light t-bold pr3 ml0 hoverable-link-text button reply ember-view"><!----><span aria-hidden="true" class="feed-shared-reply-button__text">Reply</span>
  
  </button></div>
  
    <div class="comments-comment-social-bar__social-counts"><button class="comments-comment-social-bar__likes-count t-12 t-black--light t-normal hoverable-link-text" data-control-name="comment_like_count" data-ember-action="" data-ember-action-1380="1380">
          <span aria-hidden="true">2 Likes</span>
          <span class="visually-hidden">
              2 Likes on Adam Whitmore’s comment
          </span>
        </button><!----></div>
  </div>
      </div>
  
  <div class="comments-comment-item__nested-items">
  <!---->
  <!----></div>
  
  </article>
            <article data-id="urn:li:comment:(article:8008759920368445702,6404217324580204544)" tabindex="-1" id="ember1382" class="comments-comments-list__comment-item comments-comment-item ember-view">    <div class="comments-comment-item__options">
      <time class="comments-comment-item__timestamp t-12 t-black--light t-normal">10mo</time>
  
      <artdeco-dropdown id="ember1383" class="ember-view"><artdeco-dropdown-trigger aria-expanded="false" role="button" placement="bottom" tabindex="0" id="ember1384" class="comment-options-trigger ember-view">    <li-icon type="ellipsis-horizontal-icon" size="small" role="img" aria-label="Open options for Juan Gutierrez Andres’ comment"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M2,7H4V9H2V7ZM7,9H9V7H7V9Zm5-2V9h2V7H12Z" class="small-icon" style="fill-opacity: 1"></path></svg></li-icon>
  
  <!----></artdeco-dropdown-trigger><artdeco-dropdown-content justification="left" placement="bottom" data-dropdown="" tabindex="-1" aria-hidden="true" id="ember1385" class="dropdown-options ember-view"><!---->
  </artdeco-dropdown-content></artdeco-dropdown>
  <div id="ember1386" class="ember-view"><div id="ember1387" class="ember-view"><!----></div></div>
  
  
  <!---->  </div>
  
  <div id="ember1388" class="comments-comment-item__post-meta feed-shared-post-meta is-comment feed-shared-post-meta--is-not-sponsored ember-view"><a data-control-name="comment_actor" target="_self" href="/in/juangutierrezandres/" id="ember1389" class="tap-target feed-shared-post-meta__actor-link ember-view">    <div data-entity-hovercard-id="urn:li:fs_miniProfile:ACoAAAAghekBFN-AClYvW7q_CL-i6lxYid_H-w8" id="ember1390" class="feed-shared-avatar-image b0 member ember-view">  <div id="ember1391" class="presence-entity presence-entity--size-2 ember-view">  <div aria-label="Juan Gutierrez Andres" id="ember1392" class="avatar member EntityPhoto-circle-2 presence-entity__image EntityPhoto-circle-2 ghost-person ember-view">  <span class="visually-hidden">Juan Gutierrez Andres</span>
  </div>
  
  <div id="ember1393" class=" presence-entity__indicator presence-entity__indicator--size-2 presence-indicator presence-indicator--is-reachable presence-indicator--size-2 ember-view">
  <span class="visually-hidden">
      Status is reachable
  </span>
  </div>
  </div>
  </div>
  </a>
  <a data-control-name="comment_actor" target="_self" href="/in/juangutierrezandres/" id="ember1394" class="feed-shared-post-meta__profile-link t-16 t-black t-bold tap-target ember-view">  <h3 class="feed-shared-post-meta__actor t-12 t-black--light t-normal">
      <span class=" feed-shared-post-meta__name t-14 t-black t-bold">
          <span class="hoverable-link-text" data-entity-hovercard-id="urn:li:fs_miniProfile:ACoAAAAghekBFN-AClYvW7q_CL-i6lxYid_H-w8">Juan Gutierrez Andres</span><!---->          <span id="ember1395" class="feed-shared-post-meta__distance-badge distance-badge separator ember-view">  <span class="visually-hidden">1st degree connection</span>
  
  <span class="dist-value">1st</span>
  </span>
          <!---->    </span>
        <span class="feed-shared-post-meta__headline t-12 t-black--light t-normal">
          PRINCIPAL ENGINEER at HR Wallingford
        </span>
  <!----><!----><!----><!----><!----></h3>
  </a>
  <!----></div>
  
  <div class="comments-comment-item-content-body">
  <div id="ember1396" class="ember-view"><div id="ember1397" class="comments-comment-item__inline-show-more-text feed-shared-inline-show-more-text ember-view">          <p dir="ltr" id="ember1398" class="comments-comment-item__main-content feed-shared-main-content--comment t-12 t-black t-normal feed-shared-main-content ember-view"><span id="ember1400" class="ember-view"><span>Great article, James. Thanks for sharing</span></span><!----></p>
  <!----></div><!----><!---->
  </div></div>
  
  <div id="ember1402" class="ember-view"><!----></div>
      <div class="comments-comment-item__social-actions ">
        <div id="ember1403" class="comments-comment-social-bar display-flex ember-view"><div class="comments-comment-social-bar__action-group "><button data-control-name="comment_like_toggle" aria-pressed="true" aria-label="Like Juan Gutierrez Andres’ comment" id="ember1404" class="comments-comment-social-bar__action-button t-12 t-black--light t-bold pr3 ml0 hoverable-link-text like-button button like active ember-view"><!---->
    <span aria-hidden="true">Like</span>
  
  <span class="visually-hidden">
        Unlike Juan Gutierrez Andres’ comment
  </span>
  
  </button><button data-control-name="reply" id="ember1405" class="comments-comment-social-bar__action-button t-12 t-black--light t-bold pr3 ml0 hoverable-link-text button reply ember-view"><!----><span aria-hidden="true" class="feed-shared-reply-button__text">Reply</span>
  
  </button></div>
  
    <div class="comments-comment-social-bar__social-counts"><button class="comments-comment-social-bar__likes-count t-12 t-black--light t-normal hoverable-link-text" data-control-name="comment_like_count" data-ember-action="" data-ember-action-1406="1406">
          <span aria-hidden="true">1 Like</span>
          <span class="visually-hidden">
              1 Like on Juan Gutierrez Andres’ comment
          </span>
        </button><!----></div>
  </div>
      </div>
  
  <div class="comments-comment-item__nested-items">
  <!---->
  <!----></div>
  
  </article>
      
      <div class="comments-comments-list__show-previous-container">
        <button id="show_prev" class="button comments-comments-list__show-previous-button t-12 t-black t-normal hoverable-link-text" data-control-name="more_comments" data-ember-action="" data-ember-action-1407="1407">
          <span aria-hidden="true">Load more comments</span>
          <span class="visually-hidden">
            Show more comments on James Warren’s article
          </span>
  <!---->      </button>
      </div>
  </div>
    </div>
  </div>
          </div>
  
        <footer class="reader-related-content pv3 relative">
            <div class="reader-related-content__author display-flex align-items-center pb4 pt1">
  <a data-control-name="profile_bottom_bar" href="/in/james--warren/" id="ember1271" class="reader-related-content__author-image reader-related-content__footer-image-wrapper ember-view">              <div id="ember1272" class="feed-shared-avatar-image b0 reader-related-content__author-image member ember-view">  <img src="https://media.licdn.com/dms/image/C4D03AQFfVgF30oZvdQ/profile-displayphoto-shrink_100_100/0?e=1558569600&amp;v=beta&amp;t=F4wi7Isd9ehp8LMkdmOSE-E_V0ZNiML8z95rh_OrIGE" class="avatar member EntityPhoto-circle-5" alt="James Warren">
  </div>
  </a>            <div class="display-flex">
  <a data-control-name="profile_bottom_bar" href="/in/james--warren/" id="ember1273" class="reader-related-content__author-name ember-view">                <h2 class="t-16 t-black t-bold reader-related-content__meta-author-detail--has-hover">
                    James Warren
                  </h2>
  </a>
  <!---->            </div>
  
              <h3 class="t-14 t-black--light t-normal">GIS Analyst / Software Engineer</h3>
  
  <!---->          </div>
  <div id="ember1408" class="ember-view">
                <span class="reader-related-content__controls-wrapper display-flex pv2">
                  <div class="display-flex">
                    <h3 class="t-20 t-black t-bold">
                        More from James Warren
                    </h3>
  <a data-control-name="read-activity" href="/in/james--warren/detail/recent-activity/posts/" id="ember1409" class="reader-related-content__total-articles link pt1 pl3 ember-view">                      See all 11 articles
  </a>                </div>
                  <div class="reader-related-content__controls">
                    <div id="ember1410" class="peek-carousel-controls display-flex align-items-center ember-view">
    <button disabled="" id="ember1411" class="js-left_click peek-carousel-controls__button ember-view"><li-icon type="chevron-left-icon" size="large" role="img" aria-label="Move slides left"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M10,12l6,8.94L14.45,22,8.26,12.85a1.5,1.5,0,0,1,0-1.69L14.45,2,16,3.06Z" class="large-icon" style="fill: currentColor"></path></svg></li-icon>
  </button>
  
    <button id="ember1412" class="js-right_click peek-carousel-controls__button ember-view"><li-icon type="chevron-right-icon" size="large" role="img" aria-label="Move slides right"><svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon" focusable="false"><path d="M14,12L8,3.06,9.55,2l6.19,9.15a1.5,1.5,0,0,1,0,1.69L9.55,22,8,20.94Z" class="large-icon" style="fill: currentColor"></path></svg></li-icon>
  </button>
  
  </div>
                  </div>
                </span>
  
    <div class="peek-carousel js-slideshow">
      <ul class="peek-carousel__slides js-list">
                        <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/infoworks-icm-guis-ruby-part-2-james-warren/" id="ember1415" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1417" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  Infoworks ICM - GUIs with Ruby (Part 2)
  
  <!----></div>
  
                            <p id="ember1420" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/infoworks-icm-illusive-macros-sql-james-warren/" id="ember1422" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1424" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  Infoworks ICM - Illusive Macros in SQL
  
  <!----></div>
  
                            <p id="ember1427" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/mapbasic-comments-mapinfo-project-file-james-warren/" id="ember1429" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1431" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  MapBasic - Comments in MapInfo Project File
  
  <!----></div>
  
                            <p id="ember1434" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/encryption-infoworks-icm-using-ruby-james-warren/" id="ember1436" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1438" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  Encryption in InfoWorks ICM using Ruby
  
  <!----></div>
  
                            <p id="ember1441" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/icmexchange-ui-ruby-run-exit-james-warren/" id="ember1443" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1445" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  ICMExchange UI (Ruby) - Run at exit
  
  <!----></div>
  
                            <p id="ember1448" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/icmexchange-ruby-cross-script-data-sharing-james-warren/" id="ember1450" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1452" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  ICMExchange (Ruby) - Cross script data sharing
  
  <!----></div>
  
                            <p id="ember1455" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/infoworks-icm-reading-userflags-ruby-james-warren/" id="ember1457" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1459" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  InfoWorks ICM - Reading UserFlag details with Ruby
  
  <!----></div>
  
                            <p id="ember1462" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/infoworks-icm-ruby-script-progress-bar-james-warren/" id="ember1464" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <img class="lazy-image reader-related-content__image block" alt="">
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1466" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  InfoWorks ICM - Ruby Script Progress Bar
  
  <!----></div>
  
                            <p id="ember1469" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
                  <li class="member-post reader-related-content__article ember-view mv3 mh5">
  <a data-control-name="related" href="/pulse/creating-ids-mapinfos-mapbasic-james-warren/" id="ember1471" class="reader-related-content__link ember-view">                    <div class="reader-related-content__image-container relative">
                          <span class="reader-related-content__image reader-related-content__image--ghost"></span>
                      </div>
                      <div class="reader-related-content__container">
                          <div id="ember1473" class="reader-related-content__title t-16 t-black t-bold lt-line-clamp lt-line-clamp--multi-line ember-view" style="-webkit-line-clamp: 2">  Creating IDs with MapInfo's MapBasic
  
  <!----></div>
  
                            <p id="ember1476" class="reader-related-content__author t-14 t-black--light t-normal pt2 lt-line-clamp lt-line-clamp--single-line ember-view">  James Warren on LinkedIn
  
  <!----></p>
  
                      </div>
  </a>                </li>
  
      </ul>
    </div>
  
  
  </div>      </footer>
      </div>
    </article>